var is=Object.defineProperty,ss=Object.getOwnPropertyDescriptor,b=(e,t,i,s)=>{for(var n=s>1?void 0:s?ss(t,i):t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(n=(s?o(t,i,n):o(n))||n);return s&&n&&is(t,i,n),n};import{createId as ns,isArray as rs,isSegmentTruncated as os,isTextTruncated as as,toPlainText as Ve,wrapText as cs,wrapTextSegments as hs}from"ag-charts-core";import{Logger as ls,createId as us,createSvgElement as Ke}from"ag-charts-core";import{isObject as ds,isPlainObject as Lt}from"ag-charts-core";var Je=Symbol("BREAK"),kt="__decorator_config",_t="__decorator_accessors";function fs(e,t){re(e,t).optional=!0}function re(e,t){if(Object.getOwnPropertyDescriptor(e,kt)==null&&Object.defineProperty(e,kt,{value:{}}),Object.getOwnPropertyDescriptor(e,_t)==null){const l=Object.getPrototypeOf(e)?.[_t]?.slice()??[];Object.defineProperty(e,_t,{value:l})}const i=e[kt],s=t.toString();if(i[s]!=null)return i[s];i[s]={setters:[],getters:[],observers:[]};const n=Object.getOwnPropertyDescriptor(e,t);let r=n?.get,o=n?.set;if(r==null||o==null){const h=e[_t];let l=h.indexOf(t);l===-1&&(l=h.push(t)-1),r??(r=function(){let u=this.__accessors;return u==null&&(u=h.slice().fill(void 0),Object.defineProperty(this,"__accessors",{value:u})),u[l]}),o??(o=function(u){let d=this.__accessors;d==null&&(d=h.slice().fill(void 0),Object.defineProperty(this,"__accessors",{value:d})),d[l]=u})}return Object.defineProperty(e,t,{set:function(h){const{setters:l,observers:u}=i[s];let d;l.some(f=>f.length>2)&&(d=r.call(this));for(const f of l)if(h=f(this,t,h,d),h===Je)return;o.call(this,h);for(const f of u)f(this,h,d)},get:function(){let h=r.call(this);for(const l of i[s].getters)if(h=l(this,t,h),h===Je)return;return h},enumerable:!0,configurable:!1}),i[s]}function ps(e,t,i){return(s,n)=>{const r=re(s,n);r.setters.push(e),t&&r.getters.unshift(t),i&&Object.assign(r,i)}}function gs(e){return(t,i)=>{re(t,i).observers.push(e)}}function Ze(e){return typeof e<"u"&&kt in e}function Bt(e){const t=new Set;for(;Ze(e);)t.add(e?.[kt]),e=Object.getPrototypeOf(e);return Array.from(t).flatMap(i=>Object.keys(i))}function lt(e,t){return Array.isArray(e)?!Array.isArray(t)||e.length!==t.length?!1:e.every((i,s)=>lt(i,t[s])):Lt(e)?Lt(t)?ms(e,t,lt):!1:e===t}function ms(e,t,i){if(Object.is(e,t))return!0;for(const s of Object.keys(t))if(!(s in e))return!1;for(const s of Object.keys(e))if(!(s in t)||!i(e[s],t[s]))return!1;return!0}function Qe(...e){const t={};for(const i of e){if(!ds(i))continue;const s=Ze(i)?Bt(i):Object.keys(i);for(const n of s)Lt(t[n])&&Lt(i[n])?t[n]=Qe(t[n],i[n]):n in t||(t[n]??(t[n]=i[n]))}return t}import{boxContains as ys,boxesEqual as bs,clamp as ti}from"ag-charts-core";var ei=Symbol("interpolate");function xs(e,t,i,s=1/0){const n={nearest:void 0,distanceSquared:s};for(const r of i){const o=r.distanceSquared(e,t);if(o===0)return{nearest:r,distanceSquared:0};o<n.distanceSquared&&(n.nearest=r,n.distanceSquared=o)}return n}var At=class vt{constructor(t,i,s,n){this.x=t,this.y=i,this.width=s,this.height=n}static fromObject({x:t,y:i,width:s,height:n}){return new vt(t,i,s,n)}static merge(t){let i=1/0,s=1/0,n=-1/0,r=-1/0;for(const o of t)o.x<i&&(i=o.x),o.y<s&&(s=o.y),$(o.x,o.width)>n&&(n=$(o.x,o.width)),$(o.y,o.height)>r&&(r=$(o.y,o.height));return new vt(i,s,n-i,r-s)}static nearestBox(t,i,s){return xs(t,i,s)}toDOMRect(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.y,left:this.x,right:$(this.x,this.width),bottom:$(this.y,this.height),toJSON(){return{}}}}clone(){const{x:t,y:i,width:s,height:n}=this;return new vt(t,i,s,n)}equals(t){return bs(this,t)}containsPoint(t,i){return ys(this,t,i)}intersection(t){const i=Math.max(this.x,t.x),s=Math.max(this.y,t.y),n=Math.min($(this.x,this.width),$(t.x,t.width)),r=Math.min($(this.y,this.height),$(t.y,t.height));if(!(i>n||s>r))return new vt(i,s,n-i,r-s)}collidesBBox(t){return this.x<$(t.x,t.width)&&$(this.x,this.width)>t.x&&this.y<$(t.y,t.height)&&$(this.y,this.height)>t.y}computeCenter(){return{x:this.x+this.width/2,y:this.y+this.height/2}}isFinite(){return Number.isFinite(this.x)&&Number.isFinite(this.y)&&Number.isFinite(this.width)&&Number.isFinite(this.height)}distanceSquared(t,i){if(this.containsPoint(t,i))return 0;const s=t-ti(this.x,t,$(this.x,this.width)),n=i-ti(this.y,i,$(this.y,this.height));return s*s+n*n}shrink(t,i){if(typeof t=="number")this.applyMargin(t,i);else for(const s of Object.keys(t)){const n=t[s];typeof n=="number"&&this.applyMargin(n,s)}return this.width<0&&(this.width=0),this.height<0&&(this.height=0),this}grow(t,i){if(typeof t=="number")this.applyMargin(-t,i);else for(const s of Object.keys(t)){const n=t[s];typeof n=="number"&&this.applyMargin(-n,s)}return this}applyMargin(t,i){switch(i){case"top":this.y+=t;case"bottom":this.height-=t;break;case"left":this.x+=t;case"right":this.width-=t;break;case"vertical":this.y+=t,this.height-=t*2;break;case"horizontal":this.x+=t,this.width-=t*2;break;case void 0:this.x+=t,this.y+=t,this.width-=t*2,this.height-=t*2;break}}translate(t,i){return this.x+=t,this.y+=i,this}[ei](t,i){return new vt(this.x*(1-i)+t.x*i,this.y*(1-i)+t.y*i,this.width*(1-i)+t.width*i,this.height*(1-i)+t.height*i)}};At.zero=Object.freeze(new At(0,0,0,0)),At.NaN=Object.freeze(new At(NaN,NaN,NaN,NaN));var z=At;function $(e,t){return e===-1/0&&t===1/0?1/0:e+t}import{arraysEqual as Ms}from"ag-charts-core";var oe=(e,t)=>e===t;function x(e){return function(t,i){const s=`__${i}`;t[i]||Cs(t,i,s,e)}}function vs(e){return x(e)}function tt(e){return x(e)}function Ss(e){const t=e??{};return t.equals=Ms,x(e)}function Cs(e,t,i,s){const{changeCb:n,convertor:r,checkDirtyOnAssignment:o=!1}=s??{},c={changeCb:n,checkDirtyOnAssignment:o,convertor:r},a=ks(i,ws(Ps(As(i,c),c),c),c);Object.defineProperty(e,t,{set:a,get:function(){return this[i]},enumerable:!0,configurable:!0})}function Ps(e,t){const{convertor:i}=t;return i?function(s){e.call(this,i(s))}:e}var ii=Symbol("no-change");function ws(e,t){const{changeCb:i}=t;return i?function(s){const n=e.call(this,s);return n!==ii&&i.call(this,this),n}:e}function ks(e,t,i){const{checkDirtyOnAssignment:s}=i;return s?function(n){const r=t.call(this,n);return n?._dirty===!0&&this.markDirty(e),r}:t}function As(e,t){const{equals:i=oe}=t;return function(s){const n=this[e];return i(s,n)?ii:(this[e]=s,this.onChangeDetection(e),s)}}var ae=(e,t)=>Math.sign(e-t);function Ts(e,t){if(typeof e=="number"&&typeof t=="number")return ae(e,t);const i=typeof e=="number"?[e]:e,s=typeof t=="number"?[t]:t,n=Math.min(i.length,s.length);for(let r=0;r<n;r+=1){const o=ae(i[r],s[r]);if(o!==0)return o}return ae(i.length,s.length)}var Ds=5,Tt=class Ge{constructor(t){this.serialNumber=Ge._nextSerialNumber++,this.childNodeCounts={groups:0,nonGroups:0,thisComplexity:0,complexity:0},this.id=us(this),this.name=void 0,this.transitionOut=void 0,this.pointerEvents=0,this._datum=void 0,this._previousDatum=void 0,this.scene=void 0,this._debugDirtyProperties=void 0,this.parentNode=void 0,this.cachedBBox=void 0,this.isContainerNode=!1,this.visible=!0,this.zIndex=0,this.batchLevel=0,this.batchDirty=!1,this.name=t?.name,this.tag=t?.tag??NaN,this.zIndex=t?.zIndex??0,this.scene=t?.scene,(t?.debugDirty??Ge._debugEnabled)&&(this._debugDirtyProperties=new Map([["__first__",[]]]))}static toSVG(t,i,s){const n=t?.toSVG();if(n==null||!n.elements.length&&!n.defs?.length)return;const r=Ke("svg");if(r.setAttribute("width",String(i)),r.setAttribute("height",String(s)),r.setAttribute("viewBox",`0 0 ${i} ${s}`),r.setAttribute("overflow","visible"),n.defs?.length){const o=Ke("defs");o.append(...n.defs),r.append(o)}return r.append(...n.elements),r.outerHTML}static*extractBBoxes(t,i){for(const s of t)if(!i||s.visible&&!s.transitionOut){const n=s.getBBox();n&&(yield n)}}get datum(){return this._datum}set datum(t){this._datum!==t&&(this._previousDatum=this._datum,this._datum=t)}get previousDatum(){return this._previousDatum}get layerManager(){return this.scene?.layersManager}get imageLoader(){return this.scene?.imageLoader}closestDatum(){for(const{datum:t}of this.traverseUp(!0))if(t!=null)return t}preRender(t,i=1){if(this.childNodeCounts.groups=0,this.childNodeCounts.nonGroups=1,this.childNodeCounts.complexity=i,this.childNodeCounts.thisComplexity=i,this.batchLevel>0||this.batchDirty)throw new Error("AG Charts - illegal rendering state; batched update in progress");return this.childNodeCounts}isolatedRender(t){t.ctx.save();try{this.render(t)}catch(i){const s=i.errorCount??1;if(s>=Ds)throw i.errorCount=s,i;ls.warnOnce("Error during rendering",i,i.stack)}finally{t.ctx.restore()}}render(t){const{stats:i}=t;if(this.debugDirtyProperties(),t.debugNodeSearch){const s=this.name??this.id;t.debugNodeSearch.some(n=>typeof n=="string"?n===s:n.test(s))&&(t.debugNodes[this.name??this.id]=this)}i&&(i.nodesRendered++,i.opsPerformed+=this.childNodeCounts.thisComplexity)}setScene(t){this.scene=t}*traverseUp(t){let i=this;for(t&&(yield i);i=i.parentNode;)yield i}isRoot(){return!this.parentNode}removeChild(t){throw new Error(`AG Charts - internal error, unknown child node ${t.name??t.id} in $${this.name??this.id}`)}remove(){this.parentNode?.removeChild(this)}destroy(){this.parentNode?.removeChild(this)}batchedUpdate(t){this.batchLevel++,t(),this.batchLevel--,this.batchLevel===0&&this.batchDirty&&(this.markDirty(),this.batchDirty=!1)}setProperties(t){return this.batchLevel++,Object.assign(this,t),this.batchLevel--,this.batchLevel===0&&this.batchDirty&&(this.markDirty(),this.batchDirty=!1),this}containsPoint(t,i){return!1}pickNode(t,i){if(this.containsPoint(t,i))return this}pickNodes(t,i,s=[]){return this.containsPoint(t,i)&&s.push(this),s}getBBox(){return this.cachedBBox??(this.cachedBBox=Object.freeze(this.computeBBox())),this.cachedBBox}computeBBox(){}onChangeDetection(t){this.markDirty(t)}markDirtyChildrenOrder(){this.cachedBBox=void 0}markDirty(t){if(this.batchLevel>0){this.batchDirty=!0;return}t!=null&&this._debugDirtyProperties&&this.markDebugProperties(t),this.cachedBBox=void 0,this.parentNode?.markDirty()}markDebugProperties(t){const i=this._debugDirtyProperties?.get(t)??[],s=new Error().stack?.split(`
`).filter(n=>n!=="Error"&&!n.includes(".markDebugProperties")&&!n.includes(".markDirty")&&!n.includes("Object.assign ")&&!n.includes(`${this.constructor.name}.`))??"unknown";i.push(s[0].replace(" at ","").trim()),this._debugDirtyProperties?.set(t,i)}debugDirtyProperties(){this._debugDirtyProperties!=null&&(this._debugDirtyProperties.has("__first__")||this._debugDirtyProperties.forEach((t,i)=>{t.length>1&&(console.groupCollapsed(`Property changed multiple times before render: ${this.constructor.name}.${i} (${t.length}x)`),t.forEach(s=>console.log(s)),console.groupEnd())}),this._debugDirtyProperties.clear())}onZIndexChange(){this.parentNode?.markDirtyChildrenOrder()}toSVG(){}};Tt._nextSerialNumber=0,Tt._debugEnabled=!1,b([x()],Tt.prototype,"visible",2),b([tt({equals:lt,changeCb:e=>e.onZIndexChange()})],Tt.prototype,"zIndex",2);var Dt=Tt;import{LineSplitter as Fs,cachedTextMeasurer as si,createSvgElement as ni,isArray as ce,isString as Rs,measureTextSegments as Is,toFontString as Os,toPlainText as Ns}from"ag-charts-core";import{Logger as he,getWindow as Es,toArray as ri}from"ag-charts-core";var Ls=2e3,oi=Date.now(),_s=()=>{const e=Date.now()-oi;if(e>Ls){const t=(Math.floor(e/100)/10).toFixed(1);he.log(`**** ${t}s since last log message ****`)}oi=Date.now()},j={create(...e){return Object.assign((...i)=>{j.check(...e)&&(typeof i[0]=="function"&&(i=ri(i[0]())),_s(),he.log(...i))},{check:()=>j.check(...e),group:(i,s)=>j.check(...e)?he.logGroup(i,s):s()})},check(...e){return e.length===0&&e.push(!0),ri(Es("agChartsDebug")).some(i=>e.includes(i))},inDevelopmentMode(e){if(j.check("dev"))return e()}};import{clamp as Bs,toIterable as zs}from"ag-charts-core";function ai({context:e,pixelRatio:t,width:i,height:s}){e.save();try{e.resetTransform(),e.clearRect(0,0,Math.ceil(i*t),Math.ceil(s*t))}finally{e.restore()}}function ci(e){if(j.check("canvas")){const t=e.save.bind(e),i=e.restore.bind(e);let s=0;Object.assign(e,{save(){t(),s++},restore(){if(s===0)throw new Error("AG Charts - Unable to restore() past depth 0");i(),s--},verifyDepthZero(){if(s!==0)throw new Error(`AG Charts - Save/restore depth is non-zero: ${s}`)}})}}function hi(e,t,i){return[Math.floor(e*i),Math.floor(t*i)]}var le=class{constructor(e){const{width:t,height:i,pixelRatio:s,willReadFrequently:n=!1}=e;this.width=t,this.height=i,this.pixelRatio=s;const[r,o]=hi(t,i,s);this.canvas=new OffscreenCanvas(r,o),this.context=this.canvas.getContext("2d",{willReadFrequently:n}),this.context.setTransform(s,0,0,s,0,0),ci(this.context)}drawImage(e,t=0,i=0){return e.drawImage(this.canvas,t,i)}transferToImageBitmap(){return this.canvas.transferToImageBitmap()}resize(e,t,i){if(!(e>0&&t>0))return;const{canvas:s,context:n}=this;if(e!==this.width||t!==this.height||i!==this.pixelRatio){const[r,o]=hi(e,t,i);s.width=r,s.height=o}n.setTransform(i,0,0,i,0,0),this.width=e,this.height=t,this.pixelRatio=i}clear(){ai(this)}destroy(){this.canvas.width=0,this.canvas.height=0,this.context.clearRect(0,0,0,0),this.canvas=null,this.context=null,Object.freeze(this)}};import{boxesEqual as Gs,clamp as qs,generateUUID as ue,isString as $s}from"ag-charts-core";import{createSvgElement as Hs}from"ag-charts-core";var ut=Math.PI*2,zr=Math.PI/2;function G(e){return e%=ut,e+=ut,e%=ut,e}function li(e){return e%=ut,e<-Math.PI?e+=ut:e>=Math.PI&&(e-=ut),e}function zt(e,t,i){const s=G(e),n=G(t),r=G(i);return n<r?n<=s&&s<=r:n>r?n<=s||s<=r:t!==i}function J(e){return e/180*Math.PI}function de(e,t){return e=G(e),t=G(t),t-e+(e>t?ut:0)}function Gt(e){return e?G(J(e)):0}import{createSvgElement as Ws}from"ag-charts-core";import{Logger as fe,clamp as js}from"ag-charts-core";import{clamp as et}from"ag-charts-core";var dt=(e,t,i)=>e*(1-i)+t*i,pe=e=>{const t=e<0?-1:1,i=Math.abs(e);return i<=.04045?e/12.92:t*((i+.055)/1.055)**2.4},ge=e=>{const t=e<0?-1:1,i=Math.abs(e);return i>.0031308?t*(1.055*i**(1/2.4)-.055):12.92*e},ui=class D{constructor(t,i,s,n=1){this.r=et(0,t||0,1),this.g=et(0,i||0,1),this.b=et(0,s||0,1),this.a=et(0,n||0,1)}static validColorString(t){return t.indexOf("#")>=0?!!D.parseHex(t):t.indexOf("rgb")>=0?!!D.stringToRgba(t):D.nameToHex.has(t.toLowerCase())}static fromString(t){if(t.indexOf("#")>=0)return D.fromHexString(t);const i=D.nameToHex.get(t.toLowerCase());if(i)return D.fromHexString(i);if(t.indexOf("rgb")>=0)return D.fromRgbaString(t);throw new Error(`Invalid color string: '${t}'`)}static parseHex(t){t=t.replace(/ /g,"").slice(1);let i;switch(t.length){case 6:case 8:i=[];for(let s=0;s<t.length;s+=2)i.push(parseInt(`${t[s]}${t[s+1]}`,16));break;case 3:case 4:i=t.split("").map(s=>parseInt(s,16)).map(s=>s+s*16);break}if(i?.length>=3&&i.every(s=>s>=0))return i.length===3&&i.push(255),i}static fromHexString(t){const i=D.parseHex(t);if(i){const[s,n,r,o]=i;return new D(s/255,n/255,r/255,o/255)}throw new Error(`Malformed hexadecimal color string: '${t}'`)}static stringToRgba(t){let i=-1,s=-1;for(let c=0;c<t.length;c++){const a=t[c];if(i===-1&&a==="(")i=c;else if(a===")"){s=c;break}}if(i===-1||s===-1)return;const r=t.substring(i+1,s).split(","),o=[];for(let c=0;c<r.length;c++){const a=r[c];let h=parseFloat(a);if(!Number.isFinite(h))return;a.indexOf("%")>=0?(h=et(0,h,100),h/=100):c===3?h=et(0,h,1):(h=et(0,h,255),h/=255),o.push(h)}return o}static fromRgbaString(t){const i=D.stringToRgba(t);if(i){if(i.length===3)return new D(i[0],i[1],i[2]);if(i.length===4)return new D(i[0],i[1],i[2],i[3])}throw new Error(`Malformed rgb/rgba color string: '${t}'`)}static fromArray(t){if(t.length===4)return new D(t[0],t[1],t[2],t[3]);if(t.length===3)return new D(t[0],t[1],t[2]);throw new Error("The given array should contain 3 or 4 color components (numbers).")}static fromHSB(t,i,s,n=1){const r=D.HSBtoRGB(t,i,s);return new D(r[0],r[1],r[2],n)}static fromHSL(t,i,s,n=1){const r=D.HSLtoRGB(t,i,s);return new D(r[0],r[1],r[2],n)}static fromOKLCH(t,i,s,n=1){const r=D.OKLCHtoRGB(t,i,s);return new D(r[0],r[1],r[2],n)}static padHex(t){return t.length===1?"0"+t:t}toHexString(){let t="#"+D.padHex(Math.round(this.r*255).toString(16))+D.padHex(Math.round(this.g*255).toString(16))+D.padHex(Math.round(this.b*255).toString(16));return this.a<1&&(t+=D.padHex(Math.round(this.a*255).toString(16))),t}toRgbaString(t=3){const i=[Math.round(this.r*255),Math.round(this.g*255),Math.round(this.b*255)],s=Math.pow(10,t);return this.a!==1?(i.push(Math.round(this.a*s)/s),`rgba(${i.join(", ")})`):`rgb(${i.join(", ")})`}toString(){return this.a===1?this.toHexString():this.toRgbaString()}toHSB(){return D.RGBtoHSB(this.r,this.g,this.b)}static RGBtoOKLCH(t,i,s){const n=pe(t),r=pe(i),o=pe(s),c=Math.cbrt(.4122214708*n+.5363325363*r+.0514459929*o),a=Math.cbrt(.2119034982*n+.6806995451*r+.1073969566*o),h=Math.cbrt(.0883024619*n+.2817188376*r+.6299787005*o),l=.2104542553*c+.793617785*a-.0040720468*h,u=1.9779984951*c-2.428592205*a+.4505937099*h,d=.0259040371*c+.7827717662*a-.808675766*h,f=Math.atan2(d,u)*180/Math.PI,p=l,g=Math.hypot(u,d),m=f>=0?f:f+360;return[p,g,m]}static OKLCHtoRGB(t,i,s){const n=t,r=i*Math.cos(s*Math.PI/180),o=i*Math.sin(s*Math.PI/180),c=(n+.3963377774*r+.2158037573*o)**3,a=(n-.1055613458*r-.0638541728*o)**3,h=(n-.0894841775*r-1.291485548*o)**3,l=4.0767416621*c-3.3077115913*a+.2309699292*h,u=-1.2684380046*c+2.6097574011*a-.3413193965*h,d=-.0041960863*c-.7034186147*a+1.707614701*h,f=ge(l),p=ge(u),g=ge(d);return[f,p,g]}static RGBtoHSL(t,i,s){const n=Math.min(t,i,s),r=Math.max(t,i,s),o=(r+n)/2;let c,a;if(r===n)c=0,a=0;else{const h=r-n;a=o>.5?h/(2-r-n):h/(r+n),r===t?c=(i-s)/h+(i<s?6:0):r===i?c=(s-t)/h+2:c=(t-i)/h+4,c*=360/6}return[c,a,o]}static HSLtoRGB(t,i,s){if(t=(t%360+360)%360,i===0)return[s,s,s];const n=s<.5?s*(1+i):s+i-s*i,r=2*s-n;function o(l){return l<0&&(l+=1),l>1&&(l-=1),l<1/6?r+(n-r)*6*l:l<1/2?n:l<2/3?r+(n-r)*(2/3-l)*6:r}const c=o(t/360+1/3),a=o(t/360),h=o(t/360-1/3);return[c,a,h]}static RGBtoHSB(t,i,s){const n=Math.min(t,i,s),r=Math.max(t,i,s),o=r===0?0:(r-n)/r;let c=0;if(n!==r){const a=r-n,h=(r-t)/a,l=(r-i)/a,u=(r-s)/a;t===r?c=u-l:i===r?c=2+h-u:c=4+l-h,c/=6,c<0&&(c=c+1)}return[c*360,o,r]}static HSBtoRGB(t,i,s){t=(t%360+360)%360/360;let n=0,r=0,o=0;if(i===0)n=r=o=s;else{const c=(t-Math.floor(t))*6,a=c-Math.floor(c),h=s*(1-i),l=s*(1-i*a),u=s*(1-i*(1-a));switch(c>>0){case 0:n=s,r=u,o=h;break;case 1:n=l,r=s,o=h;break;case 2:n=h,r=s,o=u;break;case 3:n=h,r=l,o=s;break;case 4:n=u,r=h,o=s;break;case 5:n=s,r=h,o=l;break}}return[n,r,o]}static mix(t,i,s){return new D(dt(t.r,i.r,s),dt(t.g,i.g,s),dt(t.b,i.b,s),dt(t.a,i.a,s))}static lighten(t,i){const s=D.RGBtoOKLCH(t.r,t.g,t.b);return D.fromOKLCH(et(0,s[0]+i,1),s[1],s[2])}static darken(t,i){const s=D.RGBtoOKLCH(t.r,t.g,t.b);return D.fromOKLCH(et(0,s[0]-i,1),s[1],s[2])}static interpolate(t,i){const s=1/(t.length-1),n=t.map(r=>D.RGBtoOKLCH(r.r,r.g,r.b));return Array.from({length:i},(r,o)=>{const c=o/(i-1),a=t.length<=2?0:Math.min(Math.floor(c*(t.length-1)),t.length-2),h=(c-a*s)/s,l=n[a],u=n[a+1];return D.fromOKLCH(dt(l[0],u[0],h),dt(l[1],u[1],h),dt(l[2],u[2],h))})}};ui.nameToHex=new Map([["aliceblue","#F0F8FF"],["antiquewhite","#FAEBD7"],["aqua","#00FFFF"],["aquamarine","#7FFFD4"],["azure","#F0FFFF"],["beige","#F5F5DC"],["bisque","#FFE4C4"],["black","#000000"],["blanchedalmond","#FFEBCD"],["blue","#0000FF"],["blueviolet","#8A2BE2"],["brown","#A52A2A"],["burlywood","#DEB887"],["cadetblue","#5F9EA0"],["chartreuse","#7FFF00"],["chocolate","#D2691E"],["coral","#FF7F50"],["cornflowerblue","#6495ED"],["cornsilk","#FFF8DC"],["crimson","#DC143C"],["cyan","#00FFFF"],["darkblue","#00008B"],["darkcyan","#008B8B"],["darkgoldenrod","#B8860B"],["darkgray","#A9A9A9"],["darkgreen","#006400"],["darkgrey","#A9A9A9"],["darkkhaki","#BDB76B"],["darkmagenta","#8B008B"],["darkolivegreen","#556B2F"],["darkorange","#FF8C00"],["darkorchid","#9932CC"],["darkred","#8B0000"],["darksalmon","#E9967A"],["darkseagreen","#8FBC8F"],["darkslateblue","#483D8B"],["darkslategray","#2F4F4F"],["darkslategrey","#2F4F4F"],["darkturquoise","#00CED1"],["darkviolet","#9400D3"],["deeppink","#FF1493"],["deepskyblue","#00BFFF"],["dimgray","#696969"],["dimgrey","#696969"],["dodgerblue","#1E90FF"],["firebrick","#B22222"],["floralwhite","#FFFAF0"],["forestgreen","#228B22"],["fuchsia","#FF00FF"],["gainsboro","#DCDCDC"],["ghostwhite","#F8F8FF"],["gold","#FFD700"],["goldenrod","#DAA520"],["gray","#808080"],["green","#008000"],["greenyellow","#ADFF2F"],["grey","#808080"],["honeydew","#F0FFF0"],["hotpink","#FF69B4"],["indianred","#CD5C5C"],["indigo","#4B0082"],["ivory","#FFFFF0"],["khaki","#F0E68C"],["lavender","#E6E6FA"],["lavenderblush","#FFF0F5"],["lawngreen","#7CFC00"],["lemonchiffon","#FFFACD"],["lightblue","#ADD8E6"],["lightcoral","#F08080"],["lightcyan","#E0FFFF"],["lightgoldenrodyellow","#FAFAD2"],["lightgray","#D3D3D3"],["lightgreen","#90EE90"],["lightgrey","#D3D3D3"],["lightpink","#FFB6C1"],["lightsalmon","#FFA07A"],["lightseagreen","#20B2AA"],["lightskyblue","#87CEFA"],["lightslategray","#778899"],["lightslategrey","#778899"],["lightsteelblue","#B0C4DE"],["lightyellow","#FFFFE0"],["lime","#00FF00"],["limegreen","#32CD32"],["linen","#FAF0E6"],["magenta","#FF00FF"],["maroon","#800000"],["mediumaquamarine","#66CDAA"],["mediumblue","#0000CD"],["mediumorchid","#BA55D3"],["mediumpurple","#9370DB"],["mediumseagreen","#3CB371"],["mediumslateblue","#7B68EE"],["mediumspringgreen","#00FA9A"],["mediumturquoise","#48D1CC"],["mediumvioletred","#C71585"],["midnightblue","#191970"],["mintcream","#F5FFFA"],["mistyrose","#FFE4E1"],["moccasin","#FFE4B5"],["navajowhite","#FFDEAD"],["navy","#000080"],["oldlace","#FDF5E6"],["olive","#808000"],["olivedrab","#6B8E23"],["orange","#FFA500"],["orangered","#FF4500"],["orchid","#DA70D6"],["palegoldenrod","#EEE8AA"],["palegreen","#98FB98"],["paleturquoise","#AFEEEE"],["palevioletred","#DB7093"],["papayawhip","#FFEFD5"],["peachpuff","#FFDAB9"],["peru","#CD853F"],["pink","#FFC0CB"],["plum","#DDA0DD"],["powderblue","#B0E0E6"],["purple","#800080"],["rebeccapurple","#663399"],["red","#FF0000"],["rosybrown","#BC8F8F"],["royalblue","#4169E1"],["saddlebrown","#8B4513"],["salmon","#FA8072"],["sandybrown","#F4A460"],["seagreen","#2E8B57"],["seashell","#FFF5EE"],["sienna","#A0522D"],["silver","#C0C0C0"],["skyblue","#87CEEB"],["slateblue","#6A5ACD"],["slategray","#708090"],["slategrey","#708090"],["snow","#FFFAFA"],["springgreen","#00FF7F"],["steelblue","#4682B4"],["tan","#D2B48C"],["teal","#008080"],["thistle","#D8BFD8"],["tomato","#FF6347"],["transparent","#00000000"],["turquoise","#40E0D0"],["violet","#EE82EE"],["wheat","#F5DEB3"],["white","#FFFFFF"],["whitesmoke","#F5F5F5"],["yellow","#FFFF00"],["yellowgreen","#9ACD32"]]);var me=ui,ye=class{ticks(e,t,i){}niceDomain(e,t=this.domain){return t}get bandwidth(){}get step(){}get inset(){}},qt=(e,t)=>{const i=Symbol(String(t));e[i]=void 0,Object.defineProperty(e,t,{get(){return this[i]},set(s){this[i]!==s&&(this[i]=s,this.invalid=!0)},enumerable:!0,configurable:!1})},di=e=>{const t=me.fromString(e),[i,s,n]=me.RGBtoOKLCH(t.r,t.g,t.b);return{l:i,c:s,h:n,a:t.a}},be=1e-6,fi=e=>e.c<be||e.l<be||e.l>1-be,Ys=(e,t,i)=>{i=js(0,i,1);let s;if(fi(e))s=t.h;else if(fi(t))s=e.h;else{const c=e.h;let a=t.h;const h=t.h-e.h;h>180?a-=360:h<-180&&(a+=360),s=c*(1-i)+a*i}const n=e.c*(1-i)+t.c*i,r=e.l*(1-i)+t.l*i,o=e.a*(1-i)+t.a*i;return me.fromOKLCH(r,n,s,o)},$t=class extends ye{constructor(){super(...arguments),this.type="color",this.defaultTickCount=0,this.invalid=!0,this.domain=[0,1],this.range=["red","blue"],this.parsedRange=this.range.map(di)}update(){const{domain:e,range:t}=this;e.length<2&&(fe.warnOnce("`colorDomain` should have at least 2 values."),e.length===0?e.push(0,1):e.length===1&&e.push(e[0]+1));for(let i=1;i<e.length;i++){const s=e[i-1],n=e[i];if(s>n){fe.warnOnce("`colorDomain` values should be supplied in ascending order."),e.sort((r,o)=>r-o);break}}if(t.length<e.length)for(let i=t.length;i<e.length;i++)t.push(t.length>0?t[0]:"black");this.parsedRange=this.range.map(di)}normalizeDomains(...e){return{domain:e.flat(),animatable:!0}}toDomain(){}convert(e){this.refresh();const{domain:t,range:i,parsedRange:s}=this,n=t[0],r=t.at(-1),o=i[0],c=i[i.length-1];if(e<=n)return o;if(e>=r)return c;let a,h;if(t.length===2){const d=(e-n)/(r-n),f=1/(i.length-1);a=i.length<=2?0:Math.min(Math.floor(d*(i.length-1)),i.length-2),h=(d-a*f)/f}else{for(a=0;a<t.length-2&&!(e<t[a+1]);a++);const d=t[a],f=t[a+1];h=(e-d)/(f-d)}const l=s[a],u=s[a+1];return Ys(l,u,h).toRgbaString()}invert(){}refresh(){this.invalid&&(this.invalid=!1,this.update(),this.invalid&&fe.warnOnce("Expected update to not invalidate scale"))}};b([qt],$t.prototype,"domain",2),b([qt],$t.prototype,"range",2);var xe=class{constructor(e,t=[],i){this.colorSpace=e,this.stops=t,this.bbox=i,this._cache=void 0}createGradient(e,t,i){const s=this.bbox??t;if(!s.isFinite())return;if(this._cache!=null&&this._cache.ctx===e&&this._cache.bbox.equals(s))return this._cache.gradient;const{stops:n,colorSpace:r}=this;if(n.length===0)return;if(n.length===1)return n[0].color;let o=this.createCanvasGradient(e,s,i);if(o==null)return;const c=r==="oklch",a=.05;let h=n[0];o.addColorStop(h.stop,h.color);for(let l=1;l<n.length;l+=1){const u=n[l];if(c){const d=new $t;d.domain=[h.stop,u.stop],d.range=[h.color,u.color];for(let f=h.stop+a;f<u.stop;f+=a)o.addColorStop(f,d.convert(f))}o.addColorStop(u.stop,u.color),h=u}return"createPattern"in o&&(o=o.createPattern()),this._cache={ctx:e,bbox:s,gradient:o},o}toSvg(e){const t=this.bbox??e,i=this.createSvgGradient(t);return this.stops.forEach(({stop:s,color:n})=>{const r=Ws("stop");r.setAttribute("offset",`${s}`),r.setAttribute("stop-color",`${n}`),i.appendChild(r)}),i}},Xs=class extends xe{constructor(e,t,i=0,s){super(e,t,s),this.angle=i}createCanvasGradient(e,t,i){const{angle:n}=this,r=Gt(n+-90),o=i?.centerX??t.x+t.width*.5,c=i?.centerY??t.y+t.height*.5;return e.createConicGradient(r,o,c)}createSvgGradient(e){return Hs("linearGradient")}};import{createSvgElement as Us}from"ag-charts-core";var Vs=class extends xe{constructor(e,t,i=0,s){super(e,t,s),this.angle=i}getGradientPoints(e){const{angle:i}=this,s=Gt(i+90),n=Math.cos(s),r=Math.sin(s),o=e.width,c=e.height,a=e.x+o*.5,h=e.y+c*.5,l=Math.sqrt(c*c+o*o)/2,u=Math.atan2(c,o);let d;s<Math.PI/2?d=s:s<Math.PI?d=Math.PI-s:s<1.5*Math.PI?d=s-Math.PI:d=2*Math.PI-s;const f=l*Math.abs(Math.cos(d-u));return{x0:a+n*f,y0:h+r*f,x1:a-n*f,y1:h-r*f}}createCanvasGradient(e,t){const{x0:i,y0:s,x1:n,y1:r}=this.getGradientPoints(t);if(!(isNaN(i)||isNaN(s)||isNaN(n)||isNaN(r)))return e.createLinearGradient(i,s,n,r)}createSvgGradient(e){const{x0:t,y0:i,x1:s,y1:n}=this.getGradientPoints(e),r=Us("linearGradient");return r.setAttribute("x1",String(t)),r.setAttribute("y1",String(i)),r.setAttribute("x2",String(s)),r.setAttribute("y2",String(n)),r.setAttribute("gradientUnits","userSpaceOnUse"),r}};import{createSvgElement as Ks}from"ag-charts-core";var Js=class extends xe{constructor(e,t,i){super(e,t,i)}createCanvasGradient(e,t,i){const s=i?.centerX??t.x+t.width*.5,n=i?.centerY??t.y+t.height*.5,r=i?.innerRadius??0,o=i?.outerRadius??Math.hypot(t.width*.5,t.height*.5)/Math.SQRT2;return e.createRadialGradient(s,n,r,s,n,o)}createSvgGradient(e){const t=e.x+e.width*.5,i=e.y+e.height*.5,s=Ks("radialGradient");return s.setAttribute("cx",String(t)),s.setAttribute("cy",String(i)),s.setAttribute("r",String(Math.hypot(e.width*.5,e.height*.5)/Math.SQRT2)),s.setAttribute("gradientUnits","userSpaceOnUse"),s}};import{Logger as Zs}from"ag-charts-core";import{Logger as Me,isArray as Qs,isPlainObject as tn}from"ag-charts-core";var H=fs,ve=class{handleUnknownProperties(e,t){}set(e){const{className:t=this.constructor.name}=this.constructor;if(e==null)return this.clear(),this;if(typeof e!="object")return Me.warn(`unable to set ${t} - expecting a properties object`),this;const i=new Set(Object.keys(e));for(const s of Bt(this))if(i.has(s)){const n=e[s],r=this;if(Se(r[s]))if(r[s]instanceof pi){const o=r[s].reset(n);o==null?Me.warn(`unable to set [${String(s)}] - expecting a properties array`):r[s]=o}else r[s].set(n);else tn(n)?r[s]=Qe(n,r[s]??{}):r[s]=n;i.delete(s)}this.handleUnknownProperties(i,e);for(const s of i)Me.warn(`unable to set [${String(s)}] in ${t} - property is unknown`);return this}clear(){for(const e of Bt(this)){const t=this[e];Se(t)?t.clear():this[e]=void 0}return this}toJson(){return Bt(this).reduce((e,t)=>{const i=this[t];return e[String(t)]=Se(i)?i.toJson():i,e},{})}},pi=class Qi extends Array{constructor(t,...i){super(i.length);const n=(r=>!!r?.prototype?.constructor?.name)(t)?r=>new t().set(r):t;Object.defineProperty(this,"itemFactory",{value:n,enumerable:!1,configurable:!1}),this.set(i)}set(t){if(Qs(t)){this.length=t.length;for(let i=0;i<t.length;i++)this[i]=this.itemFactory(t[i])}return this}reset(t){if(Array.isArray(t))return new Qi(this.itemFactory,...t)}toJson(){return this.map(t=>t?.toJson?.()??t)}};function Se(e){return e instanceof ve||e instanceof pi}var gi=class extends ve{constructor(){super(...arguments),this.color="black"}};b([H],gi.prototype,"stop",2),b([H],gi.prototype,"color",2);function en(e){let t;for(const i of e)if(i?.stop!=null){if(t!=null&&i.stop<t)return!1;t=i.stop}return!0}function mi(e){return e.flatMap((t,i)=>{const{stop:s}=t,n=e.at(i+1)?.color;return n!=null?[t,{stop:s,color:n}]:[t]})}function sn(e,t){const i=t==="discrete"?1:0,s=e.map((n,r,{length:o})=>({stop:(r+i)/(o-1+i),color:n}));return t==="discrete"?mi(s):s}function nn(e,t,i,s="continuous"){const n=e.map(p=>typeof p=="string"?{color:p}:p);if(n.length===0)return sn(t,s);if(!en(n))return Zs.warnOnce("[fills] must have the stops defined in ascending order"),[];const r=Math.min(...i),o=Math.max(...i),c=s==="discrete",a=new Float64Array(n.length);let h=0,l=-1;for(let p=0;p<n.length;p+=1){const g=n[p];if(p>=l){l=n.length-1;for(let y=p+1;y<n.length;y+=1)if(n[y]?.stop!=null){l=y;break}}let m=g?.stop;if(m==null){const y=n[h]?.stop,v=n[l]?.stop,P=y??r,w=v??o,A=c&&y==null?1:0;m=P+(w-P)*(p-h+A)/(l-h+A)}else h=p;a[p]=Math.max(0,Math.min(1,(m-r)/(o-r)))}let u=n.find(p=>p.color!=null)?.color,d;const f=n.map((p,g)=>{let m=p?.color;const y=a[g];return m!=null?u=m:u!=null?m=u:(d==null&&(d=new $t,d.domain=[0,1],d.range=t),m=d.convert(y)),{stop:y,color:m}});return s==="discrete"?mi(f):f}import{Logger as rn,createSvgElement as Ce}from"ag-charts-core";var on=class{constructor(e,t){this.imageLoader=e,this._cache=void 0,this.url=t.url,this.backgroundFill=t.backgroundFill??"black",this.backgroundFillOpacity=t.backgroundFillOpacity??1,this.repeat=t.repeat??"no-repeat",this.width=t.width,this.height=t.height,this.fit=t.fit??"stretch",this.rotation=t.rotation??0}createCanvasImage(e,t,i,s){if(!t)return null;const[n,r]=this.getSize(t.width,t.height,i,s);return n<1||r<1?(rn.warnOnce("Image fill is too small to render, ignoring."),null):e.createPattern(t,this.repeat)}getSize(e,t,i,s){const{fit:n}=this;let r=e,o=t,c=1;const a=i/s,h=e/t;return n==="stretch"||e===0||t===0?(r=i,o=s):n==="contain"?c=h>a?i/e:s/t:n==="cover"&&(c=h>a?s/t:i/e),[Math.max(1,r*c),Math.max(1,o*c)]}setImageTransform(e,t){if(typeof e=="string")return;const{url:i,rotation:s,width:n,height:r}=this,o=this.imageLoader?.loadImage(i);if(!o)return;const c=Gt(s),a=Math.cos(c),h=Math.sin(c),[l,u]=this.getSize(o.width,o.height,n??t.width,r??t.height),d=l/o.width,f=u/o.height,p=t.x+t.width/2,g=t.y+t.height/2,m=a*l-h*u,y=h*l+a*u,v=m/2,P=y/2;e?.setTransform(new DOMMatrix([a*d,h*f,-h*d,a*f,p-v,g-P]))}createPattern(e,t,i,s){const n=this.width??t,r=this.height??i,o=this._cache;if(o!=null&&o.ctx===e&&o.width===n&&o.height===r)return o.pattern;const c=this.imageLoader?.loadImage(this.url,s),a=this.createCanvasImage(e,c,n,r);if(a!=null)return this._cache={ctx:e,pattern:a,width:n,height:r},a}toSvg(e,t){const{url:i,rotation:s,backgroundFill:n,backgroundFillOpacity:r}=this,{x:o,y:c,width:a,height:h}=e,l=Ce("pattern");l.setAttribute("viewBox",`0 0 ${a} ${h}`),l.setAttribute("x",String(o)),l.setAttribute("y",String(c)),l.setAttribute("width",String(a)),l.setAttribute("height",String(h)),l.setAttribute("patternUnits","userSpaceOnUse");const u=Ce("rect");u.setAttribute("x","0"),u.setAttribute("y","0"),u.setAttribute("width",String(a)),u.setAttribute("height",String(h)),u.setAttribute("fill",n),u.setAttribute("fill-opacity",String(r)),l.appendChild(u);const d=Ce("image");return d.setAttribute("href",i),d.setAttribute("x","0"),d.setAttribute("y","0"),d.setAttribute("width",String(a)),d.setAttribute("height",String(h)),d.setAttribute("preserveAspectRatio","none"),d.setAttribute("transform",`scale(${1/t}) rotate(${s}, ${a/2}, ${h/2})`),l.appendChild(d),l}};import{Logger as an,createSvgElement as Pe}from"ag-charts-core";function yi(e,t,i,s){const n=e-i,r=t-s;return n*n+r*r}function we(e,t,i,s,n,r,o){if(i===n&&s===r)return Math.min(o,yi(e,t,i,s));const c=n-i,a=r-s,h=Math.max(0,Math.min(1,((e-i)*c+(t-s)*a)/(c*c+a*a))),l=i+h*c,u=s+h*a;return Math.min(o,yi(e,t,l,u))}import{Logger as bi}from"ag-charts-core";var cn=/^[\t\n\f\r ]*([achlmqstvz])[\t\n\f\r ]*/i,F=/^[+-]?((\d*\.\d+)|(\d+\.)|(\d+))(e[+-]?\d+)?/i,hn=/[\t\n\f\r ]*,?[\t\n\f\r ]*/,xi=/^[01]/,ln={z:[],h:[F],v:[F],m:[F,F],l:[F,F],t:[F,F],s:[F,F,F,F],q:[F,F,F,F],c:[F,F,F,F,F,F],a:[F,F,F,xi,xi,F,F]};function un(e){if(!e)return;const t=[];let i=0,s;for(;i<e.length;){const n=cn.exec(e.slice(i));let r;if(n==null){if(!s){bi.warnOnce(`Invalid SVG path, error at index ${i}: Missing command.`);return}r=s}else r=n[1],i+=n[0].length;const o=dn(r,e,i);if(!o)return;i=o[0],s=r,t.push(o[1])}return t}function dn(e,t,i){const s=ln[e.toLocaleLowerCase()],n={command:e,params:[]};for(const r of s){const o=t.slice(i),c=r.exec(o);if(c!=null){n.params.push(parseFloat(c[0])),i+=c[0].length;const a=hn.exec(o.slice(c[0].length));a!=null&&(i+=a[0].length)}else{if(n.params.length===1)return[i,n];bi.warnOnce(`Invalid SVG path, error at index ${i}: No path segment parameters for command [${e}]`);return}}return[i,n]}function fn(e,t){const i=-t/e;return e!==0&&i>=0&&i<=1?[i]:[]}function pn(e,t,i,s=1e-6){if(Math.abs(e)<s)return fn(t,i);const n=t*t-4*e*i,r=[];if(Math.abs(n)<s){const o=-t/(2*e);o>=0&&o<=1&&r.push(o)}else if(n>0){const o=Math.sqrt(n),c=(-t-o)/(2*e),a=(-t+o)/(2*e);c>=0&&c<=1&&r.push(c),a>=0&&a<=1&&r.push(a)}return r}function gn(e,t,i,s,n=1e-6){if(Math.abs(e)<n)return pn(t,i,s,n);const r=t/e,o=i/e,c=s/e,a=(3*o-r*r)/9,h=(9*r*o-27*c-2*r*r*r)/54,l=a*a*a+h*h,u=1/3,d=[];if(l>=0){const f=Math.sqrt(l),p=Math.sign(h+f)*Math.pow(Math.abs(h+f),u),g=Math.sign(h-f)*Math.pow(Math.abs(h-f),u),m=Math.abs(Math.sqrt(3)*(p-g)/2),y=-u*r+(p+g);if(y>=0&&y<=1&&d.push(y),Math.abs(m)<n){const v=-u*r-(p+g)/2;v>=0&&v<=1&&d.push(v)}}else{const f=Math.acos(h/Math.sqrt(-a*a*a)),p=u*r,g=2*Math.sqrt(-a),m=g*Math.cos(u*f)-p,y=g*Math.cos(u*(f+2*Math.PI))-p,v=g*Math.cos(u*(f+4*Math.PI))-p;m>=0&&m<=1&&d.push(m),y>=0&&y<=1&&d.push(y),v>=0&&v<=1&&d.push(v)}return d}function ke(e,t,i,s,n,r,o,c){const a=(i-e)*(c-r)-(s-t)*(o-n);if(a===0)return 0;const h=((o-n)*(t-r)-(e-n)*(c-r))/a,l=((i-e)*(t-r)-(s-t)*(e-n))/a;return h>=0&&h<=1&&l>=0&&l<=1?1:0}function mn(e,t,i,s,n,r,o,c,a,h,l,u){let d=0;const f=h-u,p=l-a,g=a*(u-h)-h*(l-a),m=Mi(e,i,n,o),y=Mi(t,s,r,c),v=f*m[0]+p*y[0],P=f*m[1]+p*y[1],w=f*m[2]+p*y[2],A=f*m[3]+p*y[3]+g,k=gn(v,P,w,A);for(const M of k){const S=M*M,C=M*S,T=m[0]*C+m[1]*S+m[2]*M+m[3],R=y[0]*C+y[1]*S+y[2]*M+y[3];let N;a===l?N=(R-h)/(u-h):N=(T-a)/(l-a),N>=0&&N<=1&&d++}return d}function Mi(e,t,i,s){return[-e+3*t-3*i+s,3*e-6*t+3*i,-3*e+3*t,e]}import{insertListItemsSorted as yn}from"ag-charts-core";function Ht(e,t,i,s,n){return(1-n)**3*e+3*(1-n)**2*n*t+3*(1-n)*n**2*i+n**3*s}function bn(e,t,i,s,n,r,o,c,a){const h=(1-a)*e+a*i,l=(1-a)*t+a*s,u=(1-a)*i+a*n,d=(1-a)*s+a*r,f=(1-a)*n+a*o,p=(1-a)*r+a*c,g=(1-a)*h+a*u,m=(1-a)*l+a*d,y=(1-a)*u+a*f,v=(1-a)*d+a*p,P=(1-a)*g+a*y,w=(1-a)*m+a*v;return[[{x:e,y:t},{x:h,y:l},{x:g,y:m},{x:P,y:w}],[{x:P,y:w},{x:y,y:v},{x:f,y:p},{x:o,y:c}]]}function vi(e,t,i,s){const n=-e+3*t-3*i+s,r=2*(e-2*t+i),o=-e+t;if(n===0){if(r!==0){const a=-o/r;if(a>0&&a<1)return[a]}return[]}const c=r*r-4*n*o;if(c>=0){const a=Math.sqrt(c),h=(-r+a)/(2*n),l=(-r-a)/(2*n);return[h,l].filter(u=>u>0&&u<1)}return[]}function xn(e,t,i,s,n,r,o,c){const a=vi(e,i,n,o),h=vi(t,s,r,c);return[...a,...h]}function Ae(e,t,i){const s=Ht(e[0].x,e[1].x,e[2].x,e[3].x,.5),n=Ht(e[0].y,e[1].y,e[2].y,e[3].y,.5),r=Math.hypot(s-t,n-i),o=Math.min(Math.hypot(e[0].x-t,e[0].y-i),Math.hypot(e[1].x-t,e[1].y-i),Math.hypot(e[2].x-t,e[2].y-i),Math.hypot(e[3].x-t,e[3].y-i));return{points:e,distance:r,minDistance:o}}function Mn(e,t,i,s,n,r,o,c,a,h,l=1){let d={value:Ae([{x:e,y:t},{x:i,y:s},{x:n,y:r},{x:o,y:c}],a,h),next:null},f;for(;d!=null;){const{points:p,distance:g,minDistance:m}=d.value;if(d=d.next,(f==null||g<f.distance)&&(f={distance:g,minDistance:m}),f!=null&&f.distance-m<=l)continue;const[y,v]=bn(p[0].x,p[0].y,p[1].x,p[1].y,p[2].x,p[2].y,p[3].x,p[3].y,.5),P=[Ae(y,a,h),Ae(v,a,h)].sort(Si);d=yn(d,P,Si)}return f?.distance??1/0}var Si=(e,t)=>t.minDistance-e.minDistance,Ft=class{constructor(){this.path2d=new Path2D,this.previousCommands=[],this.previousParams=[],this.previousClosedPath=!1,this.commands=[],this.params=[],this.cx=NaN,this.cy=NaN,this.sx=NaN,this.sy=NaN,this.openedPath=!1,this.closedPath=!1}isEmpty(){return this.commands.length===0}isDirty(){return this.closedPath!==this.previousClosedPath||this.previousCommands.length!==this.commands.length||this.previousParams.length!==this.params.length||this.previousCommands.toString()!==this.commands.toString()||this.previousParams.toString()!==this.params.toString()}getPath2D(){return this.path2d}moveTo(e,t){this.openedPath=!0,this.sx=e,this.sy=t,this.cx=e,this.cy=t,this.path2d.moveTo(e,t),this.commands.push(0),this.params.push(e,t)}lineTo(e,t){this.openedPath?(this.cx=e,this.cy=t,this.path2d.lineTo(e,t),this.commands.push(1),this.params.push(e,t)):this.moveTo(e,t)}cubicCurveTo(e,t,i,s,n,r){this.openedPath||this.moveTo(e,t),this.path2d.bezierCurveTo(e,t,i,s,n,r),this.commands.push(2),this.params.push(e,t,i,s,n,r)}closePath(){this.openedPath&&(this.cx=this.sx,this.cy=this.sy,this.sx=NaN,this.sy=NaN,this.path2d.closePath(),this.commands.push(3),this.openedPath=!1,this.closedPath=!0)}rect(e,t,i,s){this.moveTo(e,t),this.lineTo(e+i,t),this.lineTo(e+i,t+s),this.lineTo(e,t+s),this.closePath()}roundRect(e,t,i,s,n){n=Math.min(n,i/2,s/2),this.moveTo(e,t+n),this.arc(e+n,t+n,n,Math.PI,1.5*Math.PI),this.lineTo(e+n,t),this.lineTo(e+i-n,t),this.arc(e+i-n,t+n,n,1.5*Math.PI,2*Math.PI),this.lineTo(e+i,t+n),this.lineTo(e+i,t+s-n),this.arc(e+i-n,t+s-n,n,0,Math.PI/2),this.lineTo(e+i-n,t+s),this.lineTo(e+n,t+s),this.arc(e+ +n,t+s-n,n,Math.PI/2,Math.PI),this.lineTo(e,t+s-n),this.closePath()}ellipse(e,t,i,s,n,r,o,c=!1){const a=i,h=s/i,l=Math.cos(n),u=Math.sin(n),d=-h*u,f=h*l,p=a*Math.cos(r),g=a*Math.sin(r),m=e+l*p+d*g,y=t+u*p+f*g,v=(m-this.cx)**2+(y-this.cy)**2;this.openedPath?v>1e-6&&this.lineTo(m,y):this.moveTo(m,y);let P=c?-G(r-o):G(o-r);Math.abs(Math.abs(o-r)-2*Math.PI)<1e-6&&P<2*Math.PI&&(P+=2*Math.PI*(c?-1:1));const w=Math.max(Math.ceil(Math.abs(P)/(Math.PI/2)),1),A=P/w,k=4/3*Math.tan(A/4);for(let M=0;M<w;M+=1){const S=r+A*(M+0),C=r+A*(M+1),T=a*Math.sin(S),R=a*Math.cos(S),N=a*Math.sin(C),B=a*Math.cos(C),pt=R-k*T,gt=T+k*R,St=B+k*N,Ct=N-k*B,Pt=B,wt=N;this.cubicCurveTo(e+l*pt+d*gt,t+u*pt+f*gt,e+l*St+d*Ct,t+u*St+f*Ct,e+l*Pt+d*wt,t+u*Pt+f*wt)}}arc(e,t,i,s,n,r){this.ellipse(e,t,i,i,0,s,n,r)}appendSvg(e){const t=un(e);if(t==null)return!1;let i=0,s=0,n,r,o=0,c=0;for(const{command:a,params:h}of t){n??(n=h[0]),r??(r=h[1]);const l=a===a.toLowerCase(),u=l?n:0,d=l?r:0;switch(a.toLowerCase()){case"m":this.moveTo(u+h[0],d+h[1]),n=u+h[0],r=d+h[1],i=n,s=r;break;case"c":this.cubicCurveTo(u+h[0],d+h[1],u+h[2],d+h[3],u+h[4],d+h[5]),o=u+h[2],c=d+h[3],n=u+h[4],r=d+h[5];break;case"s":this.cubicCurveTo(n+n-o,r+r-c,u+h[0],d+h[1],u+h[2],d+h[3]),o=u+h[0],c=d+h[1],n=u+h[2],r=d+h[3];break;case"q":this.cubicCurveTo((u+2*h[0])/3,(d+2*h[1])/3,(2*h[0]+h[2])/3,(2*h[1]+h[3])/3,h[2],h[3]),o=h[0],c=h[1],n=h[2],r=h[3];break;case"t":this.cubicCurveTo((n+2*(n+n-o))/3,(r+2*(r+r-c))/3,(2*(n+n-o)+h[0])/3,(2*(r+r-c)+h[1])/3,h[0],h[1]),o=n+n-o,c=r+r-c,n=h[0],r=h[1];break;case"a":this.svgEllipse(n,r,h[0],h[1],h[2]*Math.PI/180,h[3],h[4],u+h[5],d+h[6]),n=u+h[5],r=d+h[6];break;case"h":this.lineTo(u+h[0],r),n=u+h[0];break;case"l":this.lineTo(u+h[0],d+h[1]),n=u+h[0],r=d+h[1];break;case"v":this.lineTo(n,d+h[0]),r=d+h[0];break;case"z":this.closePath(),n=i,r=s;break;default:throw new Error(`Could not translate command '${a}' with '${h.join(" ")}'`)}}return!0}svgEllipse(e,t,i,s,n,r,o,c,a){i=Math.abs(i),s=Math.abs(s);const h=(e-c)/2,l=(t-a)/2,u=Math.sin(n),d=Math.cos(n),f=d*h+u*l,p=-u*h+d*l,g=f/i,m=p/s;let y=g*g+m*m,v=(e+c)/2,P=(t+a)/2,w=0,A=0;y>=1?(y=Math.sqrt(y),i*=y,s*=y):(y=Math.sqrt(1/y-1),r===o&&(y=-y),w=y*i*m,A=-y*s*g,v+=d*w-u*A,P+=u*w+d*A);const k=Math.atan2((p-A)/s,(f-w)/i),M=Math.atan2((-p-A)/s,(-f-w)/i)-k,S=k+M,C=!!(1-o);this.ellipse(v,P,i,s,n,k,S,C)}clear(e){e&&(this.previousCommands=this.commands,this.previousParams=this.params,this.previousClosedPath=this.closedPath),this.path2d=new Path2D,this.openedPath=!1,this.closedPath=!1,this.commands=[],this.params=[]}isPointInPath(e,t){const i=this.commands,s=this.params,n=i.length,r=-1e4,o=-1e4;let c=NaN,a=NaN,h=0,l=0,u=0;for(let d=0,f=0;d<n;d++)switch(i[d]){case 0:u+=ke(c,a,h,l,r,o,e,t),h=s[f++],c=h,l=s[f++],a=l;break;case 1:u+=ke(h,l,s[f++],s[f++],r,o,e,t),h=s[f-2],l=s[f-1];break;case 2:u+=mn(h,l,s[f++],s[f++],s[f++],s[f++],s[f++],s[f++],r,o,e,t),h=s[f-2],l=s[f-1];break;case 3:u+=ke(c,a,h,l,r,o,e,t);break}return u%2===1}distanceSquared(e,t){let i=1/0;const s=this.commands,n=this.params,r=s.length;let o=NaN,c=NaN,a=0,h=0;for(let l=0,u=0;l<r;l++)switch(s[l]){case 0:a=o=n[u++],h=c=n[u++];break;case 1:{const d=a,f=h;a=n[u++],h=n[u++],i=we(e,t,d,f,a,h,i);break}case 2:{const d=a,f=h,p=n[u++],g=n[u++],m=n[u++],y=n[u++];a=n[u++],h=n[u++],i=Mn(d,f,p,g,m,y,a,h,e,t)**2;break}case 3:i=we(e,t,a,h,o,c,i);break}return i}toSVG(e=(t,i)=>({x:t,y:i})){const t=[],{commands:i,params:s}=this,n=(o,c)=>{t.push(o);for(let a=0;a<c;a+=2){const{x:h,y:l}=e(s[r++],s[r++]);t.push(h,l)}};let r=0;for(const o of i)switch(o){case 0:n("M",2);break;case 1:n("L",2);break;case 2:n("C",6);break;case 3:n("Z",0);break}return t.join(" ")}computeBBox(){const{commands:e,params:t}=this;let[i,s,n,r]=[1/0,1/0,-1/0,-1/0],[o,c]=[NaN,NaN],[a,h]=[NaN,NaN];const l=(d,f)=>{i=Math.min(f,i),s=Math.min(d,s),n=Math.max(d,n),r=Math.max(f,r),o=d,c=f};let u=0;for(const d of e)switch(d){case 0:l(t[u++],t[u++]),a=o,h=c;break;case 1:l(t[u++],t[u++]);break;case 2:{const f=o,p=c,g=t[u++],m=t[u++],y=t[u++],v=t[u++],P=t[u++],w=t[u++];xn(f,p,g,m,y,v,P,w).forEach(k=>{const M=Ht(f,g,y,P,k),S=Ht(p,m,v,w,k);l(M,S)}),l(P,w);break}case 3:l(a,h),a=NaN,h=NaN;break}return new z(s,i,n-s,r-i)}};function L(e,t,i){const s=Math.round(t*e)/e;return i==null?s:i===0?0:i<1?Math.ceil(i*e)/e:Math.round((i+t)*e)/e-s}function Ci(e,t){return Math.floor(t*e)/e}function Te(e,t,i){const{width:s,height:n,padding:r,strokeWidth:o}=t,c=s/2,a=n/2,h=Math.max(1,s-r-o/2),l=Math.max(1,n-r-o/2);let u=!1;for(const[d,f]of i){const p=c+(d-.5)*h,g=a+(f-.5)*l;u?e.lineTo(p,g):e.moveTo(p,g),u=!0}e.closePath()}var Pi={circles(e,{width:t,strokeWidth:i,padding:s}){const n=t/2,r=Math.max(1,n-s-i/2);e.arc(n,n,r,0,Math.PI*2)},squares(e,{width:t,height:i,pixelRatio:s,padding:n,strokeWidth:r}){const o=n+r/2;e.moveTo(L(s,o),L(s,o)),e.lineTo(L(s,t-o),L(s,o)),e.lineTo(L(s,t-o),L(s,i-o)),e.lineTo(L(s,o),L(s,i-o)),e.closePath()},triangles(e,t){Te(e,t,[[.5,0],[1,1],[0,1]])},diamonds(e,t){Te(e,t,[[.5,0],[1,.5],[.5,1],[0,.5]])},stars(e,{width:t,height:i,padding:s}){const r=Math.max(1,(t-s)/2),o=r/2,c=Math.PI/2;for(let a=0;a<5*2;a++){const h=a%2===0?r:o,l=a*Math.PI/5-c,u=t/2+Math.cos(l)*h,d=i/2+Math.sin(l)*h;e.lineTo(u,d)}e.closePath()},hearts(e,{width:t,height:i,padding:s}){const n=Math.max(1,t/4-s/2),r=t/2,o=i/2+n/2;e.arc(r-n,o-n,n,J(130),J(330)),e.arc(r+n,o-n,n,J(220),J(50)),e.lineTo(r,o+n),e.closePath()},crosses(e,t){Te(e,t,[[.25,0],[.5,.25],[.75,0],[1,.25],[.75,.5],[1,.75],[.75,1],[.5,.75],[.25,1],[0,.75],[.25,.5],[0,.25]])},"vertical-lines"(e,{width:t,height:i,pixelRatio:s,strokeWidth:n}){const r=L(s,t/2)-n%2/2;e.moveTo(r,0),e.lineTo(r,i)},"horizontal-lines"(e,{width:t,height:i,pixelRatio:s,strokeWidth:n}){const r=L(s,i/2)-n%2/2;e.moveTo(0,r),e.lineTo(t,r)},"forward-slanted-lines"(e,{width:t,height:i,strokeWidth:s}){const n=Math.atan2(i,t),r=s*Math.cos(n),o=s*Math.sin(n);e.moveTo(-r,o),e.lineTo(r,-o),e.moveTo(-r,i+o),e.lineTo(t+r,-o),e.moveTo(t-r,i+o),e.lineTo(t+r,i-o)},"backward-slanted-lines"(e,{width:t,height:i,strokeWidth:s}){const n=Math.atan2(i,t),r=s*Math.cos(n),o=s*Math.sin(n);e.moveTo(t-r,-o),e.lineTo(t+r,o),e.moveTo(-r,-o),e.lineTo(t+r,i+o),e.moveTo(-r,i-o),e.lineTo(r,i+o)}},vn=class{constructor(e){this._cache=void 0,this.width=Math.max(e?.width??10,1),this.height=Math.max(e?.height??10,1),this.fill=e.fill??"none",this.fillOpacity=e.fillOpacity??1,this.backgroundFill=e.backgroundFill??"none",this.backgroundFillOpacity=e.backgroundFillOpacity??1,this.stroke=e.stroke??"black",this.strokeOpacity=e.strokeOpacity??1,this.strokeWidth=e.strokeWidth??1,this.padding=e.padding??1,this.pattern=e.pattern??"forward-slanted-lines",this.rotation=e.rotation??0,this.scale=e.scale??1,this.path=e.path}getPath(e){const{pattern:t,width:i,height:s,padding:n,strokeWidth:r,path:o}=this,c=new Ft;let a=Pi[t]!=null;return o&&a&&(a=!c.appendSvg(o)),a&&Pi[t](c,{width:i,height:s,pixelRatio:e,strokeWidth:r,padding:n}),c}renderStroke(e,t){const{stroke:i,strokeWidth:s,strokeOpacity:n}=this;s&&(t.strokeStyle=i,t.lineWidth=s,t.globalAlpha=n,t.stroke(e))}renderFill(e,t){const{fill:i,fillOpacity:s}=this;i!=="none"&&(t.fillStyle=i,t.globalAlpha=s,t.fill(e))}createCanvasPattern(e,t){const{width:i,height:s,scale:n,backgroundFill:r,backgroundFillOpacity:o}=this;if(i*n<1||s*n<1)return an.warnOnce("Pattern fill is too small to render, ignoring."),null;const c=new le({width:i,height:s,pixelRatio:t*n}),a=c.context;r!=="none"&&(a.fillStyle=r,a.globalAlpha=o,a.fillRect(0,0,i,s));const h=this.getPath(t).getPath2D();this.renderFill(h,a),this.renderStroke(h,a);const l=e.createPattern(c.canvas,"repeat");return this.setPatternTransform(l,t),c.destroy(),l}setPatternTransform(e,t,i=0,s=0){if(e==null)return;const n=Gt(this.rotation),r=1/t,o=Math.cos(n)*r,c=Math.sin(n)*r;e.setTransform(new DOMMatrix([o,c,-c,o,i,s]))}createPattern(e,t){if(this._cache!=null&&this._cache.ctx===e&&this._cache.pixelRatio===t)return this._cache.pattern;const i=this.createCanvasPattern(e,t);if(i!=null)return this._cache={ctx:e,pattern:i,pixelRatio:t},i}toSvg(){const{width:e,height:t,fill:i,fillOpacity:s,backgroundFill:n,backgroundFillOpacity:r,stroke:o,strokeWidth:c,strokeOpacity:a,rotation:h,scale:l}=this,u=Pe("pattern");u.setAttribute("viewBox",`0 0 ${e} ${t}`),u.setAttribute("width",String(e)),u.setAttribute("height",String(t)),u.setAttribute("patternUnits","userSpaceOnUse");const d=Pe("rect");d.setAttribute("x","0"),d.setAttribute("y","0"),d.setAttribute("width",String(e)),d.setAttribute("height",String(t)),d.setAttribute("fill",n),d.setAttribute("fill-opacity",String(r)),u.appendChild(d);const f=Pe("path");return f.setAttribute("fill",i),f.setAttribute("fill-opacity",String(s)),f.setAttribute("stroke-opacity",String(a)),f.setAttribute("stroke",o),f.setAttribute("stroke-width",String(c)),f.setAttribute("transform",`rotate(${h}) scale(${l})`),f.setAttribute("d",this.getPath(1).toSVG()),u.appendChild(f),u}};import{isObject as De}from"ag-charts-core";function wi(e){return De(e)&&e.type=="gradient"}function ki(e){return e!==null&&De(e)&&e.type=="pattern"}function Ai(e){return e!==null&&De(e)&&e.type=="image"}function Ti(e,t){const{fontStyle:i,fontWeight:s,fontSize:n,fontFamily:r}=t;i&&e.setAttribute("font-style",i),s&&e.setAttribute("font-weight",String(s)),n!=null&&e.setAttribute("font-size",String(n)),r&&e.setAttribute("font-family",r)}function Sn(e,t){const{stroke:i,strokeWidth:s,strokeOpacity:n}=t;i&&e.setAttribute("stroke",i),s!=null&&e.setAttribute("stroke-width",String(s)),n!=null&&e.setAttribute("stroke-opacity",String(n))}function Cn(e,t){const{lineDash:i,lineDashOffset:s}=t;if(i?.some(n=>n!==0)){const n=i.length%2===1?[...i,...i]:i;e.setAttribute("stroke-dasharray",n.join(" ")),s!=null&&e.setAttribute("stroke-dashoffset",String(s))}}var _=class extends Dt{constructor(){super(...arguments),this.fillOpacity=1,this.strokeOpacity=1,this.fill="black",this.strokeWidth=0,this.lineDashOffset=0,this.opacity=1}getGradient(e){if(wi(e))return this.createGradient(e)}createGradient(e){const{colorSpace:t="rgb",gradient:i="linear",colorStops:s,rotation:n=0,reverse:r=!1}=e;if(s==null)return;let o=nn(s,["black"],[0,1]);switch(r&&(o=o.map(c=>({color:c.color,stop:1-c.stop})).reverse()),i){case"linear":return new Vs(t,o,n);case"radial":return new Js(t,o);case"conic":return new Xs(t,o,n)}}getPattern(e){if(ki(e))return this.createPattern(e)}createPattern(e){return new vn(e)}getImage(e){if(Ai(e))return this.createImage(e)}createImage(e){return new on(this.imageLoader,e)}onFillChange(){typeof this.fill=="object"&&lt(this._cachedFill??{},this.fill)||(this.fillGradient=this.getGradient(this.fill),this.fillPattern=this.getPattern(this.fill),this.fillImage=this.getImage(this.fill),this._cachedFill=this.fill)}onStrokeChange(){this.strokeGradient=this.getGradient(this.stroke)}align(e,t){return L(this.layerManager?.canvas?.pixelRatio??1,e,t)}markDirty(e){super.markDirty(e),this.cachedDefaultGradientFillBBox=void 0}fillStroke(e,t){this.renderFill(e,t),this.renderStroke(e,t)}renderFill(e,t){const{fill:i,fillOpacity:s,fillImage:n}=this;if(i!=null&&i!=="none"&&s>0){const{globalAlpha:r}=e;n&&(e.globalAlpha=n.backgroundFillOpacity,e.fillStyle=n.backgroundFill,this.executeFill(e,t),e.globalAlpha=r),this.applyFillAndAlpha(e),this.applyShadow(e),this.executeFill(e,t),e.globalAlpha=r,e.shadowColor="rgba(0, 0, 0, 0)"}}executeFill(e,t){t?e.fill(t):e.fill()}applyFillAndAlpha(e){const{fill:t,fillGradient:i,fillPattern:s,fillImage:n,fillOpacity:r=1,opacity:o=1}=this;if(e.globalAlpha*=o*r,i){const{fillBBox:c=this.getDefaultGradientFillBBox()??this.getBBox(),fillParams:a}=this;e.fillStyle=i.createGradient(e,c,a)??"black"}else if(s){const{x:c,y:a}=this.getBBox(),h=this.layerManager?.canvas?.pixelRatio??1,l=s.createPattern(e,h);s.setPatternTransform(l,h,c,a),l?e.fillStyle=l:(e.fillStyle=s.fill,e.globalAlpha*=s.fillOpacity)}else if(n){const c=this.getBBox(),a=n.createPattern(e,c.width,c.height,this);n.setImageTransform(a,c),e.fillStyle=a??"transparent"}else e.fillStyle=typeof t=="string"?t:"black"}applyStrokeAndAlpha(e){const{stroke:t,strokeOpacity:i=1,strokeGradient:s,opacity:n=1}=this;e.strokeStyle=s?.createGradient(e,this.getBBox())??(typeof t=="string"?t:void 0)??"black",e.globalAlpha*=n*i}applyShadow(e){const t=this.layerManager?.canvas.pixelRatio??1,i=this.fillShadow;i?.enabled&&(e.shadowColor=i.color,e.shadowOffsetX=i.xOffset*t,e.shadowOffsetY=i.yOffset*t,e.shadowBlur=i.blur*t)}renderStroke(e,t){const{stroke:i,strokeWidth:s,strokeOpacity:n,lineDash:r,lineDashOffset:o,lineCap:c,lineJoin:a,miterLimit:h}=this;if(i!=null&&i!=="none"&&s>0&&n>0){const{globalAlpha:l}=e;this.applyStrokeAndAlpha(e),e.lineWidth=s,r&&e.setLineDash(r),o&&(e.lineDashOffset=o),c&&(e.lineCap=c),a&&(e.lineJoin=a),h!=null&&(e.miterLimit=h),this.executeStroke(e,t),e.globalAlpha=l}}executeStroke(e,t){t?e.stroke(t):e.stroke()}getDefaultGradientFillBBox(){return this.cachedDefaultGradientFillBBox??(this.cachedDefaultGradientFillBBox=Object.freeze(this.computeDefaultGradientFillBBox())),this.cachedDefaultGradientFillBBox}computeDefaultGradientFillBBox(){}containsPoint(e,t){return this.isPointInPath(e,t)}applySvgFillAttributes(e,t){const{fill:i,fillOpacity:s}=this;if(typeof i=="string")e.setAttribute("fill",i);else if(wi(i)&&this.fillGradient){t??(t=[]);const n=this.fillGradient.toSvg(this.fillBBox??this.getBBox()),r=ue();n.setAttribute("id",r),t.push(n),e.setAttribute("fill",`url(#${r})`)}else if(ki(i)&&this.fillPattern){t??(t=[]);const n=this.fillPattern.toSvg(),r=ue();n.setAttribute("id",r),t.push(n),e.setAttribute("fill",`url(#${r})`)}else if(Ai(i)&&this.fillImage){t??(t=[]);const n=this.layerManager?.canvas?.pixelRatio??1,r=this.fillImage.toSvg(this.getBBox(),n),o=ue();r.setAttribute("id",o),t.push(r),e.setAttribute("fill",`url(#${o})`)}else e.setAttribute("fill","none");return e.setAttribute("fill-opacity",String(s)),t}applySvgStrokeAttributes(e){const{stroke:t,strokeOpacity:i,strokeWidth:s,lineDash:n,lineDashOffset:r}=this;Sn(e,{stroke:$s(t)?t:void 0,strokeOpacity:i,strokeWidth:s}),Cn(e,{lineDash:n,lineDashOffset:r})}};b([x()],_.prototype,"fillOpacity",2),b([x()],_.prototype,"strokeOpacity",2),b([tt({equals:lt,changeCb:e=>e.onFillChange()})],_.prototype,"fill",2),b([tt({equals:lt,changeCb:e=>e.onStrokeChange()})],_.prototype,"stroke",2),b([x()],_.prototype,"strokeWidth",2),b([Ss()],_.prototype,"lineDash",2),b([x()],_.prototype,"lineDashOffset",2),b([x()],_.prototype,"lineCap",2),b([x()],_.prototype,"lineJoin",2),b([x()],_.prototype,"miterLimit",2),b([x({convertor:e=>qs(0,e??1,1)})],_.prototype,"opacity",2),b([tt({equals:oe,checkDirtyOnAssignment:!0})],_.prototype,"fillShadow",2),b([tt({equals:Gs,changeCb:e=>e.onFillChange()})],_.prototype,"fillBBox",2),b([tt({equals:lt,changeCb:e=>e.onFillChange()})],_.prototype,"fillParams",2);import{createSvgElement as Pn}from"ag-charts-core";import{isNumberEqual as mt}from"ag-charts-core";var Di=[1,0,0,1,0,0],ft=class se{get e(){return[...this.elements]}constructor(t=Di){this.elements=[...t]}setElements(t){const i=this.elements;return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],this}get identity(){const t=this.elements;return mt(t[0],1)&&mt(t[1],0)&&mt(t[2],0)&&mt(t[3],1)&&mt(t[4],0)&&mt(t[5],0)}AxB(t,i,s){const n=t[0]*i[0]+t[2]*i[1],r=t[1]*i[0]+t[3]*i[1],o=t[0]*i[2]+t[2]*i[3],c=t[1]*i[2]+t[3]*i[3],a=t[0]*i[4]+t[2]*i[5]+t[4],h=t[1]*i[4]+t[3]*i[5]+t[5];s=s??t,s[0]=n,s[1]=r,s[2]=o,s[3]=c,s[4]=a,s[5]=h}multiplySelf(t){return this.AxB(this.elements,t.elements),this}multiply(t){const i=new Array(6);return t instanceof se?this.AxB(this.elements,t.elements,i):this.AxB(this.elements,[t.a,t.b,t.c,t.d,t.e,t.f],i),new se(i)}preMultiplySelf(t){return this.AxB(t.elements,this.elements,this.elements),this}inverse(){const t=this.elements;let i=t[0],s=t[1],n=t[2],r=t[3];const o=t[4],c=t[5],a=1/(i*r-s*n);return i*=a,s*=a,n*=a,r*=a,new se([r,-s,-n,i,n*c-r*o,s*o-i*c])}invertSelf(){const t=this.elements;let i=t[0],s=t[1],n=t[2],r=t[3];const o=t[4],c=t[5],a=1/(i*r-s*n);return i*=a,s*=a,n*=a,r*=a,t[0]=r,t[1]=-s,t[2]=-n,t[3]=i,t[4]=n*c-r*o,t[5]=s*o-i*c,this}transformPoint(t,i){const s=this.elements;return{x:t*s[0]+i*s[2]+s[4],y:t*s[1]+i*s[3]+s[5]}}transformBBox(t,i){const s=this.elements,n=s[0],r=s[1],o=s[2],c=s[3],a=t.width*.5,h=t.height*.5,l=t.x+a,u=t.y+h,d=Math.abs(a*n)+Math.abs(h*o),f=Math.abs(a*r)+Math.abs(h*c);return i??(i=new z(0,0,0,0)),i.x=l*n+u*o+s[4]-d,i.y=l*r+u*c+s[5]-f,i.width=d+d,i.height=f+f,i}toContext(t){if(this.identity)return;const i=this.elements;t.transform(i[0],i[1],i[2],i[3],i[4],i[5])}static updateTransformMatrix(t,i,s,n,r,o,c){const a=i,h=s;let l,u;a===1&&h===1?(l=0,u=0):(l=c?.scalingCenterX??0,u=c?.scalingCenterY??0);const d=n,f=Math.cos(d),p=Math.sin(d);let g,m;d===0?(g=0,m=0):(g=c?.rotationCenterX??0,m=c?.rotationCenterY??0);const y=r,v=o,P=l*(1-a)-g,w=u*(1-h)-m;return t.setElements([f*a,p*a,-p*h,f*h,f*P-p*w+g+y,p*P+f*w+m+v]),t}};function rt(e){return Ri(e.constructor)}var Fi=Symbol("isMatrixTransform");function Ri(e){return e[Fi]===!0}function Fe(e){var t,i;const s=e;if(Ri(e))return e;const n=Symbol("matrix_combined_transform");class r extends s{constructor(){super(...arguments),this[i]=new ft,this._dirtyTransform=!0}onChangeDetection(c){super.onChangeDetection(c),this._dirtyTransform=!0,!(this.batchLevel>0)&&this.markDirty("transform")}updateMatrix(c){}computeTransformMatrix(){this._dirtyTransform&&(this[n].setElements(Di),this.updateMatrix(this[n]),this._dirtyTransform=!1)}toParent(c){return this.computeTransformMatrix(),this[n].identity?c.clone():this[n].transformBBox(c)}toParentPoint(c,a){return this.computeTransformMatrix(),this[n].identity?{x:c,y:a}:this[n].transformPoint(c,a)}fromParent(c){return this.computeTransformMatrix(),this[n].identity?c.clone():this[n].inverse().transformBBox(c)}fromParentPoint(c,a){return this.computeTransformMatrix(),this[n].identity?{x:c,y:a}:this[n].inverse().transformPoint(c,a)}computeBBox(){const c=super.computeBBox();return c&&this.toParent(c)}computeBBoxWithoutTransforms(){return super.computeBBox()}pickNode(c,a){return{x:c,y:a}=this.fromParentPoint(c,a),super.pickNode(c,a)}pickNodes(c,a,h){return{x:c,y:a}=this.fromParentPoint(c,a),super.pickNodes(c,a,h)}render(c){this.computeTransformMatrix();const{ctx:a}=c,h=this[n];let l=!1;try{h.identity||(a.save(),l=!0,h.toContext(a)),super.render(c)}finally{l&&a.restore()}}toSVG(){this.computeTransformMatrix();const c=super.toSVG(),a=this[n];if(a.identity||c==null)return c;const h=Pn("g");h.append(...c.elements);const[l,u,d,f,p,g]=a.e;return h.setAttribute("transform",`matrix(${l} ${u} ${d} ${f} ${p} ${g})`),{elements:[h],defs:c.defs}}}return t=Fi,i=n,r[t]=!0,r}function Rt(e){var t;const i=e,s=Symbol("matrix_rotation");class n extends Fe(i){constructor(){super(...arguments),this[t]=new ft,this.rotationCenterX=0,this.rotationCenterY=0,this.rotation=0}updateMatrix(o){super.updateMatrix(o);const{rotation:c,rotationCenterX:a,rotationCenterY:h}=this;c!==0&&(ft.updateTransformMatrix(this[s],1,1,c,0,0,{rotationCenterX:a,rotationCenterY:h}),o.multiplySelf(this[s]))}}return t=s,b([x()],n.prototype,"rotationCenterX",2),b([x()],n.prototype,"rotationCenterY",2),b([x()],n.prototype,"rotation",2),n}function Ii(e){var t;const i=e,s=Symbol("matrix_scale");class n extends Fe(i){constructor(){super(...arguments),this[t]=new ft,this.scalingX=1,this.scalingY=1,this.scalingCenterX=0,this.scalingCenterY=0}updateMatrix(o){super.updateMatrix(o);const{scalingX:c,scalingY:a,scalingCenterX:h,scalingCenterY:l}=this;c===1&&a===1||(ft.updateTransformMatrix(this[s],c,a,0,0,0,{scalingCenterX:h,scalingCenterY:l}),o.multiplySelf(this[s]))}}return t=s,b([x()],n.prototype,"scalingX",2),b([x()],n.prototype,"scalingY",2),b([x()],n.prototype,"scalingCenterX",2),b([x()],n.prototype,"scalingCenterY",2),n}function Wt(e){var t;const i=e,s=Symbol("matrix_translation");class n extends Fe(i){constructor(){super(...arguments),this[t]=new ft,this.translationX=0,this.translationY=0}updateMatrix(o){super.updateMatrix(o);const{translationX:c,translationY:a}=this;c===0&&a===0||(ft.updateTransformMatrix(this[s],1,1,0,c,a),o.multiplySelf(this[s]))}}return t=s,b([x()],n.prototype,"translationX",2),b([x()],n.prototype,"translationY",2),n}var yt=class{static fromCanvas(e,t){const i=[];for(const s of e.traverseUp())rt(s)&&i.unshift(s);for(const s of i)t=s.fromParent(t);return rt(e)&&(t=e.fromParent(t)),t}static toCanvas(e,t){t==null?t=e.getBBox():rt(e)&&(t=e.toParent(t));for(const i of e.traverseUp())rt(i)&&(t=i.toParent(t));return t}static fromCanvasPoint(e,t,i){const s=[];for(const n of e.traverseUp())rt(n)&&s.unshift(n);for(const n of s)({x:t,y:i}=n.fromParentPoint(t,i));return rt(e)&&({x:t,y:i}=e.fromParentPoint(t,i)),{x:t,y:i}}static toCanvasPoint(e,t,i){rt(e)&&({x:t,y:i}=e.toParentPoint(t,i));for(const s of e.traverseUp())rt(s)&&({x:t,y:i}=s.toParentPoint(t,i));return{x:t,y:i}}},It,Re=class Et extends Dt{constructor(t){super(t),this.childNodes=new Set,this.dirty=!1,this.dirtyZIndex=!1,this.clipRect=void 0,this.opacity=1,this.layer=void 0,this.image=void 0,this._lastWidth=NaN,this._lastHeight=NaN,this._lastDevicePixelRatio=NaN,this.isContainerNode=!0,this.renderToOffscreenCanvas=t?.renderToOffscreenCanvas===!0,this.optimizeForInfrequentRedraws=t?.optimizeForInfrequentRedraws===!0}static is(t){return t instanceof Et}static computeChildrenBBox(t,i=!0){return z.merge(Dt.extractBBoxes(t,i))}static compareChildren(t,i){return Ts(t.zIndex,i.zIndex)||t.serialNumber-i.serialNumber}containsPoint(t,i){return!0}computeBBox(){return Et.computeChildrenBBox(this.children())}computeSafeClippingBBox(t){const i=this.computeBBox();if(i?.isFinite()!==!0)return;let s=0;const n=4;for(const d of this.descendants())d instanceof _&&(s=Math.max(s,d.strokeWidth));const r=Math.max(1,s/2*n),{x:o,y:c}=yt.toCanvasPoint(this,0,0),a=Ci(t,o+i.x-r)-o,h=Ci(t,c+i.y-r)-c,l=Math.ceil(i.x+i.width-a+r),u=Math.ceil(i.y+i.height-h+r);return new z(a,h,l,u)}prepareSharedCanvas(t,i,s){return It==null||It.pixelRatio!==s?It=new le({width:t,height:i,pixelRatio:s}):It.resize(t,i,s),It}setScene(t){super.setScene(t),this.layer&&(this.scene?.layersManager.removeLayer(this.layer),this.layer=void 0);for(const i of this.children())i.setScene(t)}markDirty(t){this.dirty=!0,super.markDirty(t)}markDirtyChildrenOrder(){super.markDirtyChildrenOrder(),this.dirtyZIndex=!0,this.markDirty()}append(t){for(const i of zs(t))i.parentNode?.removeChild(i),this.childNodes.add(i),i.parentNode=this,i.setScene(this.scene);this.markDirtyChildrenOrder(),this.markDirty()}appendChild(t){return this.append(t),t}removeChild(t){if(!this.childNodes?.delete(t))throw new Error(`AG Charts - internal error, unknown child node ${t.name??t.id} in $${this.name??this.id}`);t.parentNode=void 0,t.setScene(),this.markDirtyChildrenOrder(),this.markDirty()}clear(){for(const t of this.children())delete t.parentNode,t.setScene();this.childNodes?.clear(),this.markDirty()}pickNode(t,i){if(!(!this.visible||this.pointerEvents===1||!this.containsPoint(t,i))){if(this.childNodes!=null&&this.childNodes.size!==0){const s=[...this.children()];for(let n=s.length-1;n>=0;n--){const o=s[n].pickNode(t,i);if(o!=null)return o}}else if(!this.isContainerNode)return this}}pickNodes(t,i,s=[]){if(!this.visible||this.pointerEvents===1||!this.containsPoint(t,i))return s;this.isContainerNode||s.push(this);for(const n of this.children())n.pickNodes(t,i,s);return s}isDirty(t){const{width:i,height:s,devicePixelRatio:n}=t,{dirty:r,layer:o}=this,c=o!=null&&(this._lastWidth!==i||this._lastHeight!==s),a=this._lastDevicePixelRatio!==n;return this._lastWidth=i,this._lastHeight=s,this._lastDevicePixelRatio=n,r||c||a}preRender(t){let i;if(this.dirty){i=super.preRender(t,0);for(const s of this.children()){const n=s.preRender(t);i.groups+=n.groups,i.nonGroups+=n.nonGroups,i.complexity+=n.complexity}i.groups+=1,i.nonGroups-=1}else i=this.childNodeCounts;return this.renderToOffscreenCanvas&&!this.optimizeForInfrequentRedraws&&i.nonGroups>0&&this.getVisibility()?this.layer??(this.layer=this.layerManager?.addLayer({name:this.name})):this.layer!=null&&(this.layerManager?.removeLayer(this.layer),this.layer=void 0),i}render(t){const{layer:i,renderToOffscreenCanvas:s}=this,n={...t},r=this.isDirty(t);if(this.dirty=!1,!s){this.renderInContext(n),super.render(n);return}const{ctx:o,stats:c,devicePixelRatio:a}=t;let{image:h}=this;if(r){h?.bitmap.close(),h=void 0;const u=i?void 0:this.computeSafeClippingBBox(a),d=(f,...p)=>{const g=f.context;n.ctx=g,f.clear(),g.save();try{g.setTransform(...p),g.globalAlpha=1,this.renderInContext(n)}finally{g.restore(),g.verifyDepthZero?.()}};if(i)d(i,o.getTransform());else if(u){const{x:f,y:p,width:g,height:m}=u,y=this.prepareSharedCanvas(g,m,a);d(y,a,0,0,a,-f*a,-p*a),h={bitmap:y.transferToImageBitmap(),x:f,y:p,width:g,height:m}}this.image=h,c&&c.layersRendered++}else c&&c.layersSkipped++;const{globalAlpha:l}=o;if(o.globalAlpha=l*this.opacity,i){o.save();try{o.resetTransform(),i.drawImage(o)}finally{o.restore()}}else if(h){const{bitmap:u,x:d,y:f,width:p,height:g}=h;o.drawImage(u,0,0,p*a,g*a,d,f,p,g)}o.globalAlpha=l,super.render(n)}applyClip(t,i){const{x:s,y:n,width:r,height:o}=i;t.beginPath(),t.rect(s,n,r,o),t.clip()}renderInContext(t){const{ctx:i,stats:s}=t;this.dirtyZIndex&&(this.sortChildren(Et.compareChildren),this.dirtyZIndex=!1),i.save();try{i.globalAlpha*=this.opacity,this.clipRect!=null&&(this.applyClip(i,this.clipRect),t.clipBBox=yt.toCanvas(this,this.clipRect));for(const n of this.children()){if(!n.visible){s&&(s.nodesSkipped+=n.childNodeCounts.nonGroups+n.childNodeCounts.groups,s.opsSkipped+=n.childNodeCounts.complexity);continue}n.isolatedRender(t)}}finally{i.restore()}}sortChildren(t){if(!this.childNodes)return;const i=[...this.childNodes].sort(t);this.childNodes.clear();for(const s of i)this.childNodes.add(s)}*children(){yield*this.childNodes}*excludeChildren(t){for(const i of this.children())(t.instance&&!(i instanceof t.instance)||t.name&&i.name!==t.name)&&(yield i)}*descendants(){for(const t of this.children())yield t,t instanceof Et&&(yield*t.descendants())}setClipRect(t){this.clipRect=t?yt.fromCanvas(this,t):void 0}setClipRectCanvasSpace(t){this.clipRect=t}getVisibility(){for(const t of this.traverseUp(!0))if(!t.visible)return!1;return!0}toSVG(){if(!this.visible)return;const t=[],i=[];for(const s of this.children()){const n=s.toSVG();n!=null&&(i.push(...n.elements),n.defs!=null&&t.push(...n.defs))}return{elements:i,defs:t}}};Re.className="Group",b([x({convertor:e=>Bs(0,e,1)})],Re.prototype,"opacity",2);var U=Re,eo=class extends Ii(U){},io=class extends Rt(U){},wn=class extends Wt(U){},so=class extends Rt(Wt(U)){};import{Logger as Ie,TextMeasurer as kn,getWindow as An,isString as Tn,toArray as Dn}from"ag-charts-core";function Fn(e){for(const t of["B","KB","MB","GB"]){if(e<1536)return`${e.toFixed(1)}${t}`;e/=1024}return`${e.toFixed(1)}TB}`}function Rn(){if(!("memory"in performance))return;const{totalJSHeapSize:e,usedJSHeapSize:t,jsHeapSizeLimit:i}=performance.memory,s=[];for(const n of[t,e,i])typeof n=="number"&&s.push(Fn(n));return`Heap ${s.join(" / ")}`}function Oi(e,t,i,s,n={},r=z.zero){if(!j.check("scene:stats","scene:stats:verbose"))return;const{layersRendered:o=0,layersSkipped:c=0,nodesRendered:a=0,nodesSkipped:h=0,opsPerformed:l=0,opsSkipped:u=0}=s??{},d=performance.now(),{start:f,...p}=t,g=Object.entries(p).map(([C,T])=>Ei(C,T)).filter(C=>C!=null).join(" + "),m=Object.entries(n).map(([C,T])=>`${C}: ${JSON.stringify(T)}`).join(" ; "),y=j.check("scene:stats:verbose"),v=Rn(),P=[`${Ei("\u23F1\uFE0F",f,d)} (${g})`,`${m}`,`Layers: ${y?Oe(o,c):e.size}`,y?`Nodes: ${Oe(a,h)}`:null,y?`Ops: ${Oe(l,u)}`:null,y&&v?v:null].filter(Tn),w=new kn(i),A=new Map(P.map(C=>[C,w.measureText(C)])),k=Math.max(...Array.from(A.values(),C=>C.width)),M=_n(A.values(),C=>C.height),S=2+r.x;i.save();try{i.fillStyle="white",i.fillRect(S,0,k,M),i.fillStyle="black";let C=0;for(const[T,R]of A.entries())C+=R.height,i.fillText(T,S,C)}catch(C){Ie.warnOnce("Error during debug stats rendering",C)}finally{i.restore()}}function In(e){const t=Dn(An("agChartsSceneDebug")),i=[];for(const s of t)s==="layout"?i.push("seriesRoot","legend","root",/.*Axis-\d+-axis.*/):i.push(s);e.debugNodeSearch=i}function On(e,t){e.save();try{for(const[i,s]of Object.entries(t)){const n=yt.toCanvas(s);if(!n){Ie.log(`Scene.render() - no bbox for debugged node [${i}].`);continue}e.globalAlpha=.8,e.strokeStyle="red",e.lineWidth=1,e.strokeRect(n.x,n.y,n.width,n.height),e.fillStyle="red",e.strokeStyle="white",e.font="16px sans-serif",e.textBaseline="top",e.textAlign="left",e.lineWidth=2,e.strokeText(i,n.x,n.y,n.width),e.fillText(i,n.x,n.y,n.width)}}catch(i){Ie.warnOnce("Error during debug rendering",i)}finally{e.restore()}}var Nn=new Set,En=new Set(["gradient","zIndex","clipRect","cachedBBox","childNodeCounts","path","__zIndex","name","__scalingCenterX","__scalingCenterY","__rotationCenterX","__rotationCenterY","_previousDatum","__fill","__lineDash","borderPath","borderClipPath","_clipPath"]);function Ln(e){const{...t}=e;for(const i of Object.keys(t))En.has(i)||typeof t[i]!="number"&&typeof t[i]!="string"&&typeof t[i]!="boolean"&&(Nn.add(i),delete t[i]);return t}function jt(e,t){if(!j.check(!0,"scene"))return{};let i=0;return{node:t==="json"?Ln(e):e,name:e.name??e.id,dirty:e instanceof U?e.dirty:void 0,...Array.from(e instanceof U?e.children():[],s=>jt(s,t)).reduce((s,n)=>{let{name:r}=n;const{node:{visible:o,opacity:c,zIndex:a,translationX:h,translationY:l,rotation:u,scalingX:d,scalingY:f},node:p}=n;(!o||c<=0)&&(r=`(${r})`),U.is(p)&&p.renderToOffscreenCanvas&&(r=`*${r}*`);const g=Array.isArray(a)?`(${a.join(", ")})`:a,m=[`${(i++).toString().padStart(3,"0")}|`,`${r??"<unknown>"}`,`z: ${g}`,h&&`x: ${h}`,l&&`y: ${l}`,u&&`r: ${u}`,d!=null&&d!==1&&`sx: ${d}`,f!=null&&f!==1&&`sy: ${f}`].filter(P=>!!P).join(" ");let y=m,v=1;for(;s[y]!=null&&v<100;)y=`${m} (${v++})`;return s[y]=n,s},{})}}function Ni(e){const t=e instanceof U?e.dirty:void 0;if(!t)return{dirtyTree:{},paths:[]};const i=Array.from(e instanceof U?e.children():[],r=>Ni(r)).filter(r=>r.paths.length>0),s=U.is(e)?e.name??e.id:e.id,n=i.length?i.flatMap(r=>r.paths).map(r=>`${s}.${r}`):[s];return{dirtyTree:{name:s,node:e,dirty:t,...i.map(r=>r.dirtyTree).filter(r=>r.dirty!=null).reduce((r,o)=>(r[o.name??"<unknown>"]=o,r),{})},paths:n}}function Oe(e,t){const i=e+t;return`${e} / ${i} (${Math.round(100*e/i)}%)`}function Ei(e,t,i){const s=i!=null?i-t:t;return`${e}: ${Math.round(s*100)/100}ms`}function _n(e,t){let i=0;for(const s of e)i+=t(s);return i}import{boxesEqual as Bn,isNumberEqual as Li}from"ag-charts-core";var Yt=(e,{x0:t,y0:i,x1:s,y1:n,cx:r,cy:o},c,a)=>{if(a&&e.moveTo(t,i),t!==s||i!==n){const h=Math.atan2(i-o,t-r),l=Math.atan2(n-o,s-r);e.arc(r,o,c,h,l)}else e.lineTo(t,i)};import{createSvgElement as zn}from"ag-charts-core";var Z=class extends _{constructor(){super(...arguments),this.path=new Ft,this._clipX=NaN,this._clipY=NaN,this.clip=!1,this._dirtyPath=!0,this.lastPixelRatio=NaN}set clipX(e){this._clipX=e,this.dirtyPath=!0}set clipY(e){this._clipY=e,this.dirtyPath=!0}set dirtyPath(e){this._dirtyPath!==e&&(this._dirtyPath=e,e&&this.markDirty("path"))}get dirtyPath(){return this._dirtyPath}checkPathDirty(){this._dirtyPath||(this.dirtyPath=this.path.isDirty()||(this.fillShadow?.isDirty()??!1)||(this._clipPath?.isDirty()??!1))}resetPathDirty(){this.path.clear(!0),this._dirtyPath=!1}isPathDirty(){return this.path.isDirty()}onChangeDetection(e){this._dirtyPath||(this._dirtyPath=!0,super.onChangeDetection(e))}computeBBox(){return this.updatePathIfDirty(),this.path.computeBBox()}isPointInPath(e,t){return this.updatePathIfDirty(),this.path.closedPath&&this.path.isPointInPath(e,t)}distanceSquared(e,t){return this.distanceSquaredTransformedPoint(e,t)}svgPathData(e){return this.updatePathIfDirty(),this.path.toSVG(e)}distanceSquaredTransformedPoint(e,t){return this.updatePathIfDirty(),this.path.closedPath&&this.path.isPointInPath(e,t)?0:this.path.distanceSquared(e,t)}isDirtyPath(){return!1}updatePath(){}updatePathIfDirty(){(this.dirtyPath||this.isDirtyPath())&&(this.updatePath(),this.dirtyPath=!1)}preRender(e){return e.devicePixelRatio!==this.lastPixelRatio&&(this.dirtyPath=!0),this.lastPixelRatio=e.devicePixelRatio,this.updatePathIfDirty(),super.preRender(e,this.path.commands.length)}render(e){const{ctx:t}=e;if(this.clip&&!isNaN(this._clipX)&&!isNaN(this._clipY)){t.save();try{const i=this.strokeWidth/2;this._clipPath??(this._clipPath=new Ft),this._clipPath.clear(),this._clipPath.rect(-i,-i,this._clipX+i,this._clipY+i+i),t.clip(this._clipPath?.getPath2D()),this._clipX>0&&this._clipY>0&&this.drawPath(t)}finally{t.restore()}}else this._clipPath=void 0,this.drawPath(t);this.fillShadow?.markClean(),super.render(e)}drawPath(e){this.fillStroke(e,this.path.getPath2D())}toSVG(){if(!this.visible)return;const e=zn("path");e.setAttribute("d",this.svgPathData());const t=this.applySvgFillAttributes(e,[]);return this.applySvgStrokeAttributes(e),{elements:[e],defs:t}}};Z.className="Path",b([x()],Z.prototype,"clip",2),b([x()],Z.prototype,"clipX",1),b([x()],Z.prototype,"clipY",1);var Xt=(e,t,i,s,n)=>{let r=!1,o=!1,c=s-Math.sqrt(Math.max(n**2-i**2,0)),a=0,h=0,l=i-Math.sqrt(Math.max(n**2-s**2,0));return c>e?(r=!0,c=e,a=i-Math.sqrt(Math.max(n**2-(s-e)**2))):Li(c,0)&&(c=0),l>t?(o=!0,h=s-Math.sqrt(Math.max(n**2-(i-t)**2)),l=t):Li(l,0)&&(l=0),{leading0:c,leading1:a,trailing0:h,trailing1:l,leadingClipped:r,trailingClipped:o}},Ne=(e,t,i,s,n,r,o)=>{let{topLeft:c,topRight:a,bottomRight:h,bottomLeft:l}=r;const u=Math.max(c+l,a+h),d=Math.max(c+a,l+h);if(u<=0&&d<=0){if(o==null)e.rect(t,i,s,n);else{const M=Math.max(t,o.x),S=Math.min(t+s,o.x+o.width),C=Math.max(i,o.y),T=Math.min(i+n,o.y+o.height);e.rect(M,C,S-M,T-C)}return}else if(o==null&&c===a&&c===h&&c===l){e.roundRect(t,i,s,n,c);return}if(s<0&&(t+=s,s=Math.abs(s)),n<0&&(i+=n,n=Math.abs(n)),s<=0||n<=0)return;if(o==null)o=new z(t,i,s,n);else{const M=Math.max(t,o.x),S=Math.min(t+s,o.x+o.width),C=Math.max(i,o.y),T=Math.min(i+n,o.y+o.height);o=new z(M,C,S-M,T-C)}const f=Math.max(u/n,d/s,1);f>1&&(c/=f,a/=f,h/=f,l/=f);let p=!0,g=!0,m=!0,y=!0,v,P,w,A;if(p){const M=Xt(o.height,o.width,Math.max(t+c-o.x,0),Math.max(i+c-o.y,0),c);M.leadingClipped&&(y=!1),M.trailingClipped&&(g=!1);const S=Math.max(o.x+M.leading1,o.x),C=Math.max(o.y+M.leading0,o.y),T=Math.max(o.x+M.trailing1,o.x),R=Math.max(o.y+M.trailing0,o.y),N=t+c,B=i+c;v={x0:S,y0:C,x1:T,y1:R,cx:N,cy:B}}if(g){const M=Xt(o.width,o.height,Math.max(i+a-o.y,0),Math.max(o.x+o.width-(t+s-a),0),a);M.leadingClipped&&(p=!1),M.trailingClipped&&(m=!1);const S=Math.min(o.x+o.width-M.leading0,o.x+o.width),C=Math.max(o.y+M.leading1,o.y),T=Math.min(o.x+o.width-M.trailing0,o.x+o.width),R=Math.max(o.y+M.trailing1,o.y),N=t+s-a,B=i+a;P={x0:S,y0:C,x1:T,y1:R,cx:N,cy:B}}if(m){const M=Xt(o.height,o.width,Math.max(o.x+o.width-(t+s-h),0),Math.max(o.y+o.height-(i+n-h),0),h);M.leadingClipped&&(g=!1),M.trailingClipped&&(y=!1);const S=Math.min(o.x+o.width-M.leading1,o.x+o.width),C=Math.min(o.y+o.height-M.leading0,o.y+o.height),T=Math.min(o.x+o.width-M.trailing1,o.x+o.width),R=Math.min(o.y+o.height-M.trailing0,o.y+o.height),N=t+s-h,B=i+n-h;w={x0:S,y0:C,x1:T,y1:R,cx:N,cy:B}}if(y){const M=Xt(o.width,o.height,Math.max(o.y+o.height-(i+n-l),0),Math.max(t+l-o.x,0),l);M.leadingClipped&&(m=!1),M.trailingClipped&&(p=!1);const S=Math.max(o.x+M.leading0,o.x),C=Math.min(o.y+o.height-M.leading1,o.y+o.height),T=Math.max(o.x+M.trailing0,o.x),R=Math.min(o.y+o.height-M.trailing1,o.y+o.height),N=t+l,B=i+n-l;A={x0:S,y0:C,x1:T,y1:R,cx:N,cy:B}}let k=!1;p&&v!=null&&(Yt(e,v,c,!k),k||(k=!0)),g&&P!=null&&(Yt(e,P,a,!k),k||(k=!0)),m&&w!=null&&(Yt(e,w,h,!k),k||(k=!0)),y&&A!=null&&Yt(e,A,l,!k),e.closePath()},V=class extends Z{constructor(){super(...arguments),this.borderPath=new Ft,this.x=0,this.y=0,this.width=10,this.height=10,this.topLeftCornerRadius=0,this.topRightCornerRadius=0,this.bottomRightCornerRadius=0,this.bottomLeftCornerRadius=0,this.clipBBox=void 0,this.crisp=!1,this.lastUpdatePathStrokeWidth=this.strokeWidth,this.effectiveStrokeWidth=this.strokeWidth,this.hittester=super.isPointInPath.bind(this),this.distanceCalculator=super.distanceSquaredTransformedPoint.bind(this),this.microPixelEffectOpacity=1}set cornerRadius(e){this.topLeftCornerRadius=e,this.topRightCornerRadius=e,this.bottomRightCornerRadius=e,this.bottomLeftCornerRadius=e}isDirtyPath(){return this.lastUpdatePathStrokeWidth!==this.strokeWidth||!!(this.path.isDirty()||this.borderPath.isDirty())}updatePath(){const{path:e,borderPath:t,crisp:i,topLeftCornerRadius:s,topRightCornerRadius:n,bottomRightCornerRadius:r,bottomLeftCornerRadius:o}=this;let{x:c,y:a,width:h,height:l,strokeWidth:u,clipBBox:d}=this;const p=1/(this.layerManager?.canvas.pixelRatio??1);let g=1;if(e.clear(!0),t.clear(!0),h===0||l===0){this.effectiveStrokeWidth=0,this.lastUpdatePathStrokeWidth=0,this.microPixelEffectOpacity=0;return}if(i&&(h<=p&&(g*=h/p),l<=p&&(g*=l/p),h=this.align(c,h),l=this.align(a,l),c=this.align(c),a=this.align(a),d=d!=null?new z(this.align(d.x),this.align(d.y),this.align(d.x,d.width),this.align(d.y,d.height)):void 0),u)if(h<p){const m=c+p/2;t.moveTo(m,a),t.lineTo(m,a+l),u=p,this.borderClipPath=void 0}else if(l<p){const m=a+p/2;t.moveTo(c,m),t.lineTo(c+h,m),u=p,this.borderClipPath=void 0}else if(u<h&&u<l){const m=u/2;c+=m,a+=m,h-=u,l-=u;const y=d?.clone().shrink(m),v={topLeft:s>0?s-u:0,topRight:n>0?n-u:0,bottomRight:r>0?r-u:0,bottomLeft:o>0?o-u:0};this.borderClipPath=void 0,h>0&&l>0&&(y==null||y?.width>0&&y?.height>0)&&(Ne(e,c,a,h,l,v,y),Ne(t,c,a,h,l,v,y))}else this.borderClipPath=this.borderClipPath??new Ft,this.borderClipPath.clear(!0),this.borderClipPath.rect(c,a,h,l),t.rect(c,a,h,l);else{const m={topLeft:s,topRight:n,bottomRight:r,bottomLeft:o};this.borderClipPath=void 0,Ne(e,c,a,h,l,m,d)}if([s,n,r,o].every(m=>m===0)){const m=this.getBBox();this.hittester=m.containsPoint.bind(m),this.distanceSquared=(y,v)=>this.getBBox().distanceSquared(y,v)}else this.hittester=super.isPointInPath,this.distanceCalculator=super.distanceSquaredTransformedPoint;this.effectiveStrokeWidth=u,this.lastUpdatePathStrokeWidth=u,this.microPixelEffectOpacity=g}computeBBox(){const{x:e,y:t,width:i,height:s,clipBBox:n}=this;return n?.clone()??new z(e,t,i,s)}isPointInPath(e,t){return this.hittester(e,t)}get midPoint(){return{x:this.x+this.width/2,y:this.y+this.height/2}}distanceSquared(e,t){return this.distanceCalculator(e,t)}applyFillAndAlpha(e){super.applyFillAndAlpha(e),e.globalAlpha*=this.microPixelEffectOpacity}applyStrokeAndAlpha(e){super.applyStrokeAndAlpha(e),e.globalAlpha*=this.microPixelEffectOpacity}renderStroke(e){const{stroke:t,effectiveStrokeWidth:i}=this;if(t&&i){const{globalAlpha:s}=e,{lineDash:n,lineDashOffset:r,lineCap:o,lineJoin:c,borderPath:a,borderClipPath:h}=this;h&&e.clip(h.getPath2D()),this.applyStrokeAndAlpha(e),e.lineWidth=i,n&&e.setLineDash(n),r&&(e.lineDashOffset=r),o&&(e.lineCap=o),c&&(e.lineJoin=c),e.stroke(a.getPath2D()),e.globalAlpha=s}}};V.className="Rect",b([x()],V.prototype,"x",2),b([x()],V.prototype,"y",2),b([x()],V.prototype,"width",2),b([x()],V.prototype,"height",2),b([x()],V.prototype,"topLeftCornerRadius",2),b([x()],V.prototype,"topRightCornerRadius",2),b([x()],V.prototype,"bottomRightCornerRadius",2),b([x()],V.prototype,"bottomLeftCornerRadius",2),b([tt({equals:Bn})],V.prototype,"clipBBox",2),b([x()],V.prototype,"crisp",2);var X=class st extends _{constructor(t){super(t),this.x=0,this.y=0,this.lines=[],this.text=void 0,this.fontCache=void 0,this.fontSize=st.defaultFontSize,this.fontFamily="sans-serif",this.textAlign="start",this.textBaseline="alphabetic",this.boxPadding=0,this.trimText=t?.trimText??!0}onTextChange(){if(this.richText?.clear(),this.textMap?.clear(),ce(this.text))this.lines=[],this.richText??(this.richText=new U),this.richText.setScene(this.scene),this.richText.append(this.text.flatMap(t=>t.text.split(Fs)).filter(Boolean).map(()=>new st({trimText:!1})));else{const t=this.text?.split(`
`)??[];this.lines=this.trimText?t.map(i=>i.trim()):t}}get font(){return this.fontCache??(this.fontCache=Os(this)),this.fontCache}static computeBBox(t,i,s,n){const{font:r,lineHeight:o,textAlign:c,textBaseline:a}=n,{width:h,height:l,lineMetrics:u}=si(r).measureLines(t),d=o?o*u.length:l,f=st.calcTopOffset(d,u,a),p=st.calcLeftOffset(h,c);return new z(i-p,s-f,h,d)}static calcTopOffset(t,i,s){switch(s){case"alphabetic":return i[0]?.ascent??0;case"middle":return t/2;case"bottom":return t;default:return 0}}static calcLeftOffset(t,i){let s=0;switch(i){case"center":s=.5;break;case"right":case"end":s=1}return t*s}computeBBox(){if(this.generateTextMap(),this.textMap?.size){const c=z.merge(this.textMap.values());return c.x=this.x-st.calcLeftOffset(c.width,this.textAlign),c.y=this.y,c}const{x:t,y:i,lines:s,textBaseline:n,textAlign:r}=this,o=st.computeBBox(s,t,i,{font:this,textBaseline:n,textAlign:r});return this.boxing!=null&&o.grow(this.boxPadding),o}getTextMeasureBBox(){return this.computeBBox()}getPlainText(){return Ns(this.text)}isPointInPath(t,i){return this.getBBox()?.containsPoint(t,i)??!1}setScene(t){this.richText?.setScene(t),super.setScene(t)}generateTextMap(){if(!ce(this.text)||this.textMap?.size)return;this.textMap??(this.textMap=new Map);let t=0;const i=this.richText.children();for(const{width:s,height:n,ascent:r,segments:o}of Is(this.text,this).lineMetrics){let c=0;for(const{color:a,textMetrics:h,...l}of o){const u=i.next().value;u.x=this.x-s/2+c,u.y=r+t,u.setProperties({...l,fill:a??this.fill});const d=u.getBBox();this.textMap.set(u,d),c+=h.width}t+=n}}render(t){const{ctx:i,stats:s}=t;if(!this.text||!this.layerManager)return s&&(s.nodesSkipped+=1),super.render(t);if(ce(this.text)){this.generateTextMap();const n=this.richText.getBBox();let r=0;switch(this.textAlign){case"left":case"start":r=n.width/2;break;case"right":case"end":r=n.width/-2}this.renderBoxing(t,n.clone().translate(r,this.y)),i.save(),i.translate(r,this.y),this.richText.render(t),i.restore()}else this.renderText(t);if(st.debug.check()&&!this.textMap?.size){const n=this.getBBox();i.strokeStyle="red",i.lineWidth=1,i.strokeRect(n.x,n.y,n.width,n.height)}super.render(t)}markDirty(t){return this.textMap?.clear(),super.markDirty(t)}renderText(t){const{fill:i,stroke:s,strokeWidth:n,font:r,textAlign:o}=this;if(!i&&!(s&&n)||!this.layerManager)return super.render(t);const{ctx:c}=t;c.font!==r&&(c.font=r),c.textAlign=o,this.renderBoxing(t),this.fillStroke(c)}renderBoxing(t,i){if(!this.boxing)return;const s=i??st.computeBBox(this.lines,this.x,this.y,this);if(s.width===0||s.height===0)return;const{x:n,y:r,width:o,height:c}=s.grow(this.boxPadding);this.boxing.opacity=this.opacity,this.boxing.x=n,this.boxing.y=r,this.boxing.width=o,this.boxing.height=c,this.boxing.preRender(t),this.boxing.render(t)}executeFill(t){this.renderLines((i,s,n)=>t.fillText(i,s,n))}executeStroke(t){this.renderLines((i,s,n)=>t.strokeText(i,s,n))}renderLines(t){const{x:i,y:s,lines:n}=this;if(!Number.isFinite(i)||!Number.isFinite(s))return;const r=si(this),{lineMetrics:o}=r.measureLines(n),{textBaseline:c,lineHeight:a=o[0].height}=this;let h=0;c==="top"?h=o[0].ascent:(c==="middle"||c==="bottom")&&(h=a*(1-n.length),c==="middle"?(h/=2,h-=r.baselineDistance(c)):h-=o[0].descent);for(const l of o)t(l.text,i,s+h),h+=a}setFont(t){this.fontFamily=t.fontFamily,this.fontSize=t.fontSize,this.fontStyle=t.fontStyle,this.fontWeight=t.fontWeight}setAlign(t){this.textAlign=t.textAlign,this.textBaseline=t.textBaseline}setBoxing(t){const i=t.border?.enabled?t.border?.stroke:void 0;t.fill!=null||i!=null?(this.boxing??(this.boxing=new V({scene:this.scene})),this.boxing.fill=t.fill,this.boxing.fillOpacity=t.fillOpacity??1,this.boxing.cornerRadius=t.cornerRadius??0,this.boxing.stroke=i,this.boxing.strokeWidth=t.border?.strokeWidth??0,this.boxing.strokeOpacity=t.border?.strokeOpacity??1,this.boxPadding=t.padding??0):this.boxing&&(this.boxing.destroy(),this.boxing=void 0)}getBoxingProperties(){const{fill:t,fillOpacity:i,cornerRadius:s,stroke:n,strokeWidth:r,strokeOpacity:o}=this.boxing??{};return{border:{enabled:n!=null,stroke:n,strokeWidth:r,strokeOpacity:o},cornerRadius:s,fill:t,fillOpacity:i,padding:this.boxPadding}}toSVG(){if(!this.visible||!this.text)return;const t=ni("text");if(Rs(this.text))this.applySvgFillAttributes(t),Ti(t,this),t.setAttribute("text-anchor",{center:"middle",left:"start",right:"end",start:"start",end:"end"}[this.textAlign??"start"]),t.setAttribute("alignment-baseline",this.textBaseline),t.setAttribute("x",String(this.x)),t.setAttribute("y",String(this.y)),t.textContent=this.text;else for(const i of this.text){const s=ni("tspan");Ti(s,{fontSize:i.fontSize??this.fontSize,fontFamily:i.fontFamily??this.fontFamily,fontWeight:i.fontWeight??this.fontWeight,fontStyle:i.fontStyle??this.fontStyle}),this.applySvgFillAttributes(s),s.textContent=i.text,t.append(s)}return{elements:[t]}}};X.className="Text",X.debug=j.create(!0,"scene:text"),X.defaultFontSize=10,b([x()],X.prototype,"x",2),b([x()],X.prototype,"y",2),b([vs({changeCb:e=>e.onTextChange()})],X.prototype,"text",2),b([x({changeCb:e=>{e.fontCache=void 0}})],X.prototype,"fontStyle",2),b([x({changeCb:e=>{e.fontCache=void 0}})],X.prototype,"fontWeight",2),b([x({changeCb:e=>{e.fontCache=void 0}})],X.prototype,"fontSize",2),b([x({changeCb:e=>{e.fontCache=void 0}})],X.prototype,"fontFamily",2),b([x()],X.prototype,"textAlign",2),b([x()],X.prototype,"textBaseline",2),b([x()],X.prototype,"lineHeight",2);var _i=X,Gn=class extends Rt(_i){},ao=class extends Rt(Wt(_i)){};import"ag-charts-core";function ot(e,t){return ps((i,s,n)=>i[e][t??s]=n)}function qn(e){return gs(e)}var W=class extends ve{constructor(){super(...arguments),this.id=ns(this),this.node=new Gn({zIndex:1}).setProperties({textAlign:"center",pointerEvents:1}),this.enabled=!1,this.textAlign="center",this.fontSize=10,this.fontFamily="sans-serif",this.wrapping="always",this.padding=0,this.layoutStyle="block",this.truncated=!1}registerInteraction(e,t){return e.eventsHub.on("layout:complete",()=>this.updateA11yText(e,t))}computeTextWrap(e,t){const{text:i,padding:s,wrapping:n}=this,r=Math.min(this.maxWidth??1/0,e)-s*2,o=this.maxHeight??t-s*2,c={maxWidth:r,maxHeight:o,font:this,textWrap:n};if(!isFinite(r)&&!isFinite(o)){this.node.text=i;return}let a;rs(i)?(a=hs(i,c),this.truncated=a.some(os)):(a=cs(i??"",c),this.truncated=as(a)),this.node.text=a}updateA11yText(e,t){const{proxyInteractionService:i}=e;if(this.enabled&&this.text){const s=yt.toCanvas(this.node);if(s){const{id:n}=this;this.proxyText??(this.proxyText=i.createProxyElement({type:"text",domManagerId:n,where:t})),this.proxyText.textContent=Ve(this.text),this.proxyText.setBounds(s),this.proxyText.addListener("mousemove",r=>this.handleMouseMove(e,r)),this.proxyText.addListener("mouseleave",r=>this.handleMouseLeave(e,r))}}else this.proxyText?.destroy(),this.proxyText=void 0}handleMouseMove(e,t){if(t!=null&&this.enabled&&this.truncated){const{x:i,y:s}=yt.toCanvas(this.node),n=t.sourceEvent.offsetX+i,r=t.sourceEvent.offsetY+s;e.tooltipManager.updateTooltip(this.id,{canvasX:n,canvasY:r,showArrow:!1},[{type:"structured",title:Ve(this.text)}])}}handleMouseLeave(e,t){e.tooltipManager.removeTooltip(this.id)}};W.SMALL_PADDING=10,b([H,ot("node","visible")],W.prototype,"enabled",2),b([H,ot("node")],W.prototype,"text",2),b([H,ot("node")],W.prototype,"textAlign",2),b([H,ot("node")],W.prototype,"fontStyle",2),b([H,ot("node")],W.prototype,"fontWeight",2),b([H,ot("node")],W.prototype,"fontSize",2),b([H,ot("node")],W.prototype,"fontFamily",2),b([H,ot("node","fill")],W.prototype,"color",2),b([H],W.prototype,"spacing",2),b([H],W.prototype,"maxWidth",2),b([H],W.prototype,"maxHeight",2),b([H],W.prototype,"wrapping",2),b([H],W.prototype,"padding",2),b([H],W.prototype,"layoutStyle",2);function Ut(e,t){const{path:i,size:s}=e,{x:n,y:r}=e;i.clear();let o=!1;for(const[c,a]of t){const h=n+(c-.5)*s,l=r+(a-.5)*s;o?i.lineTo(h,l):i.moveTo(h,l),o=!0}i.closePath()}var $n={circle({path:e,x:t,y:i,size:s}){const n=s/2;e.arc(t,i,n,0,Math.PI*2),e.closePath()},cross(e){Ut(e,[[.25,0],[.5,.25],[.75,0],[1,.25],[.75,.5],[1,.75],[.75,1],[.5,.75],[.25,1],[0,.75],[.25,.5],[0,.25]])},diamond(e){Ut(e,[[.5,0],[1,.5],[.5,1],[0,.5]])},heart({path:e,x:t,y:i,size:s}){const n=s/4;i=i+n/2,e.arc(t-n,i-n,n,J(130),J(330)),e.arc(t+n,i-n,n,J(220),J(50)),e.lineTo(t,i+n),e.closePath()},pin({path:e,x:t,y:i,size:s}){e.moveTo(t+(.15625-.5)*s,i+(.34375-.5)*s),e.cubicCurveTo(t+(.15625-.5)*s,i+(.151491-.5)*s,t+(.307741-.5)*s,i+(0-.5)*s,t+(.5-.5)*s,i+(0-.5)*s),e.cubicCurveTo(t+(.692259-.5)*s,i+(0-.5)*s,t+(.84375-.5)*s,i+(.151491-.5)*s,t+(.84375-.5)*s,i+(.34375-.5)*s),e.cubicCurveTo(t+(.84375-.5)*s,i+(.493824-.5)*s,t+(.784625-.5)*s,i+(.600181-.5)*s,t+(.716461-.5)*s,i+(.695393-.5)*s),e.cubicCurveTo(t+(.699009-.5)*s,i+(.719769-.5)*s,t+(.681271-.5)*s,i+(.743104-.5)*s,t+(.663785-.5)*s,i+(.766105-.5)*s),e.cubicCurveTo(t+(.611893-.5)*s,i+(.834367-.5)*s,t+(.562228-.5)*s,i+(.899699-.5)*s,t+(.528896-.5)*s,i+(.980648-.5)*s),e.cubicCurveTo(t+(.524075-.5)*s,i+(.992358-.5)*s,t+(.512663-.5)*s,i+(1-.5)*s,t+(.5-.5)*s,i+(1-.5)*s),e.cubicCurveTo(t+(.487337-.5)*s,i+(1-.5)*s,t+(.475925-.5)*s,i+(.992358-.5)*s,t+(.471104-.5)*s,i+(.980648-.5)*s),e.cubicCurveTo(t+(.487337-.5)*s,i+(1-.5)*s,t+(.475925-.5)*s,i+(.992358-.5)*s,t+(.471104-.5)*s,i+(.980648-.5)*s),e.cubicCurveTo(t+(.437772-.5)*s,i+(.899699-.5)*s,t+(.388107-.5)*s,i+(.834367-.5)*s,t+(.336215-.5)*s,i+(.766105-.5)*s),e.cubicCurveTo(t+(.318729-.5)*s,i+(.743104-.5)*s,t+(.300991-.5)*s,i+(.719769-.5)*s,t+(.283539-.5)*s,i+(.695393-.5)*s),e.cubicCurveTo(t+(.215375-.5)*s,i+(.600181-.5)*s,t+(.15625-.5)*s,i+(.493824-.5)*s,t+(.15625-.5)*s,i+(.34375-.5)*s),e.closePath()},plus(e){Ut(e,[[1/3,0],[2/3,0],[2/3,1/3],[1,1/3],[1,2/3],[2/3,2/3],[2/3,1],[1/3,1],[1/3,2/3],[0,2/3],[0,1/3],[1/3,1/3]])},square({path:e,x:t,y:i,size:s,pixelRatio:n}){const r=s/2;e.moveTo(L(n,t-r),L(n,i-r)),e.lineTo(L(n,t+r),L(n,i-r)),e.lineTo(L(n,t+r),L(n,i+r)),e.lineTo(L(n,t-r),L(n,i+r)),e.closePath()},star({path:e,x:t,y:i,size:s}){const r=s/2,o=r/2,c=Math.PI/2;for(let a=0;a<5*2;a++){const h=a%2===0?r:o,l=a*Math.PI/5-c,u=t+Math.cos(l)*h,d=i+Math.sin(l)*h;e.lineTo(u,d)}e.closePath()},triangle(e){Ut(e,[[.5,0],[1,.87],[0,.87]])}},Ot=class extends Z{constructor(){super(...arguments),this.shape="square",this.x=0,this.y=0,this.size=12}isPointInPath(e,t){return this.distanceSquared(e,t)<=0}get midPoint(){return{x:this.x,y:this.y}}distanceSquared(e,t){const i=Vt.anchor(this.shape);return Math.max(Math.hypot(e-this.x+(i.x-.5)*this.size,t-this.y+(i.y-.5)*this.size)-this.size/2,0)}updatePath(){const{path:e,shape:t,x:i,y:s,size:n}=this,r=this.layerManager?.canvas?.pixelRatio??1,o=Vt.anchor(t),c={path:e,x:i-(o.x-.5)*n,y:s-(o.y-.5)*n,size:n,pixelRatio:r};e.clear(),typeof t=="string"?$n[t](c):typeof t=="function"&&t(c)}computeBBox(){const{x:e,y:t,size:i}=this,s=Vt.anchor(this.shape);return new z(e-i*s.x,t-i*s.y,i,i)}executeFill(e,t){if(t)return super.executeFill(e,t)}executeStroke(e,t){if(t)return super.executeStroke(e,t)}};b([tt({equals:oe})],Ot.prototype,"shape",2),b([x()],Ot.prototype,"x",2),b([x()],Ot.prototype,"y",2),b([x({convertor:Math.abs})],Ot.prototype,"size",2);var Vt=class extends Rt(Ii(Wt(Ot))){static anchor(e){return e==="pin"?{x:.5,y:1}:typeof e=="function"&&"anchor"in e?e.anchor:{x:.5,y:.5}}constructor(e){super(e),e?.shape!=null&&(this.shape=e.shape)}};import{clamp as Bi}from"ag-charts-core";import"ag-charts-core";function Hn(e){if(e.length===0)return[];const t=[1/0,-1/0];for(const i of e)i<t[0]&&(t[0]=i),i>t[1]&&(t[1]=i);return t}function zi(e){return e=e|0,e<=0?0:e===1?1:1<<31-Math.clz32(e)}var Kt=1e3,bt=Kt*60,Jt=bt*60,Nt=Jt*24,Wn=Nt*7,Gi=Nt*30,jn=Nt*365,xt=new Date().getTimezoneOffset()*bt,Yn={millisecond:{milliseconds:1,hierarchy:"day",encode(e){return e.getTime()},decode(e){return new Date(e)}},second:{milliseconds:Kt,hierarchy:"day",encode(e,t){const i=t?0:xt;return Math.floor((e.getTime()-i)/Kt)},decode(e,t){const i=t?0:xt;return new Date(i+e*Kt)}},minute:{milliseconds:bt,hierarchy:"day",encode(e,t){const i=t?0:xt;return Math.floor((e.getTime()-i)/bt)},decode(e,t){const i=t?0:xt;return new Date(i+e*bt)}},hour:{milliseconds:Jt,hierarchy:"day",encode(e,t){const i=t?0:xt;return Math.floor((e.getTime()-i)/Jt)},decode(e,t){const i=t?0:xt;return new Date(i+e*Jt)}},day:{milliseconds:Nt,hierarchy:"month",encode(e,t){const i=t?0:e.getTimezoneOffset()*bt;return Math.floor((e.getTime()-i)/Nt)},decode(e,t){let i;return t?(i=new Date(0),i.setUTCDate(i.getUTCDate()+e),i.setUTCHours(0,0,0,0)):(i=new Date(1970,0,1),i.setDate(i.getDate()+e)),i}},month:{milliseconds:Gi,hierarchy:"year",encode(e,t){return t?e.getUTCFullYear()*12+e.getUTCMonth():e.getFullYear()*12+e.getMonth()},decode(e,t){if(t){const i=Math.floor(e/12),s=e-i*12;return new Date(Date.UTC(i,s,1))}else{const i=Math.floor(e/12),s=e-i*12;return new Date(i,s,1)}}},year:{milliseconds:jn,hierarchy:void 0,encode(e,t){return t?e.getUTCFullYear():e.getFullYear()},decode(e,t){let i;return t?(i=new Date,i.setUTCFullYear(e),i.setUTCMonth(0,1),i.setUTCHours(0,0,0,0)):i=new Date(e,0,1,0,0,0,0),i}}};function Xn(e){return typeof e=="string"?e:e.unit}function Un(e){return typeof e=="string"?1:e.step??1}function Vn(e){return Un(e)*Yn[Xn(e)].milliseconds}function Ee(e){return e instanceof Date?e.getTime():e}import{Logger as Kn,clamp as Zt}from"ag-charts-core";var Le=class ts extends ye{constructor(){super(...arguments),this.invalid=!0,this.range=[0,1],this.round=!1,this._bandwidth=1,this._step=1,this._inset=1,this._rawBandwidth=1,this._paddingInner=0,this._paddingOuter=0}static is(t){return t instanceof ts}get bandwidth(){return this.refresh(),this._bandwidth}get step(){return this.refresh(),this._step}get inset(){return this.refresh(),this._inset}get rawBandwidth(){return this.refresh(),this._rawBandwidth}set padding(t){t=Zt(0,t,1),this._paddingInner=t,this._paddingOuter=t}get padding(){return this._paddingInner}set paddingInner(t){this.invalid=!0,this._paddingInner=Zt(0,t,1)}get paddingInner(){return this._paddingInner}set paddingOuter(t){this.invalid=!0,this._paddingOuter=Zt(0,t,1)}get paddingOuter(){return this._paddingOuter}refresh(){this.invalid&&(this.invalid=!1,this.update(),this.invalid&&Kn.warnOnce("Expected update to not invalidate scale"))}convert(t,i){this.refresh();const s=this.findIndex(t,i?.alignment);return s==null||s<0||s>=this.bands.length?NaN:this.ordinalRange(s)}invertNearestIndex(t){this.refresh();const i=this.bands.length;if(i===0)return-1;let s=0,n=i-1,r=1/0,o=0;for(;s<=n;){const c=(n+s)/2|0,a=this.ordinalRange(c),h=Math.abs(a-t);if(h===0)return c;h<r&&(r=h,o=c),a<t?s=c+1:n=c-1}return o}update(){const[t,i]=this.range;let{_paddingInner:s}=this;const{_paddingOuter:n,bands:r}=this,o=r.length;if(o===0)return;const c=i-t;let a;o===1?(s=0,a=c*(1-n*2)):a=c/Math.max(1,o-s+n*2);const h=this.round&&Math.floor(a)>0,l=h?Math.floor(a):a;let u=t+(c-l*(o-s))/2,d=l*(1-s);h&&(u=Math.round(u),d=Math.round(d)),this._step=l,this._inset=u,this._bandwidth=d,this._rawBandwidth=a*(1-s)}ordinalRange(t){const{_inset:i,_step:s,range:n}=this,r=Math.min(n[0],n[1]),o=Math.max(n[0],n[1]);return Zt(r,i+s*t,o)}};b([qt],Le.prototype,"range",2),b([qt],Le.prototype,"round",2);var Jn=Le;import{clamp as qi}from"ag-charts-core";function Zn(e,t,i){if(i==null||i[0]===0&&i[1]===1)return;const s=qi(0,Math.floor(i[0]*e.length),e.length),n=qi(0,Math.ceil(i[1]*e.length),e.length),r=t?e.length-n:s,o=t?e.length-s:n;return[r,o]}function Qn(e,t,i){const s=Zn(e,t,i);if(s==null)return{ticks:e,count:e.length,firstTickIndex:0};const[n,r]=s;return{ticks:e.slice(n,r),count:e.length,firstTickIndex:n}}var tr=class es extends Jn{constructor(){super(...arguments),this.type="category",this.defaultTickCount=0,this.index=new Map,this.indexInitialized=!1,this._domain=[]}static is(t){return t instanceof es}set domain(t){this._domain!==t&&(this.invalid=!0,this._domain=t,this.index.clear(),this.indexInitialized=!1)}get domain(){return this._domain}get bands(){return this._domain}normalizeDomains(...t){let i;const s=new Set;let n=!0;for(const r of t)s.has(r)||(s.add(r),i==null?i=$i(r):(n&&(n=er(r,i)),i=$i([...i,...r])));return i??(i=[]),{domain:i,animatable:n}}toDomain(t){}invert(t,i=!1){this.refresh();const s=i?this.bandwidth/2:0,n=this.invertNearestIndex(Math.max(0,t-s));return i||t===this.ordinalRange(n)?this.domain[n]:void 0}ticks(t,i=this.domain,s){const{bands:n}=this;let{tickCount:r}=t;if(r===0){const g=n.length>1?1:0;return{ticks:n[g]?[n[g]]:[],count:void 0,firstTickIndex:g}}let o=r!=null&&r!==0?n.length/r|0:1;if(o=zi(o),o<=1)return Qn(i,!1,s);r=n.length/o|0;const c=o*r,a=zi((n.length-c)/2|0),h=Bi(0,Math.floor((s?.[0]??0)*n.length),n.length),l=Bi(0,Math.ceil((s?.[1]??1)*n.length),n.length),u=Math.floor((h-a)/o)*o+a,d=Math.ceil((l-a)/o)*o+a,f=[];for(let g=u;g<d;g+=o)g>=0&&g<n.length&&f.push(n[g]);let p=f.length>0?this.findIndex(f[0]):void 0;return p!=null&&(p=Math.floor((p-a)/o)),{ticks:f,count:void 0,firstTickIndex:p}}findIndex(t){const{index:i,indexInitialized:s}=this;if(!s){const{domain:n}=this;for(let r=0;r<n.length;r++)i.set(Ee(n[r]),r);this.indexInitialized=!0}return i.get(Ee(t))}};function $i(e){let t;const i=new Set;for(const s of e){const n=Ee(s),r=i.size;i.add(n),i.size!==r?t?.push(s):t??(t=e.slice(0,i.size))}return t??e}function er(e,t){let i=-1;for(const s of e){const n=t.indexOf(s);if(n===-1)i=1/0;else{if(n<=i)return!1;i=n}}return!0}import{Logger as ir,clamp as sr,countFractionDigits as nr}from"ag-charts-core";function rr(e,[t,i],[s,n]){const r=n-s,o=i-t,c=t+o*e[0],a=t+o*e[1];return[(c-s)/r,(a-s)/r]}var O=(e,t)=>({duration:Vn(e)*t,timeInterval:e,step:t}),xo=[O({unit:"second"},1),O({unit:"second"},5),O({unit:"second"},15),O({unit:"second"},30),O({unit:"minute"},1),O({unit:"minute"},5),O({unit:"minute"},15),O({unit:"minute"},30),O({unit:"hour"},1),O({unit:"hour"},3),O({unit:"hour"},6),O({unit:"hour"},12),O({unit:"day"},1),O({unit:"day"},2),O({unit:"day",step:7},1),O({unit:"day",step:7},2),O({unit:"day",step:7},3),O({unit:"month"},1),O({unit:"month"},2),O({unit:"month"},3),O({unit:"month"},4),O({unit:"month"},6),O({unit:"year"},1)],Hi=[1,2,5,10];function Wi(e,t){return Math.abs(Math.round(e)-e)<t}function ji(e,t,i){return Math.abs(t-e)>=i?Math.abs(t-e)/i+1:1}function or(e,t,i,s,n,r){if(e===t)return{ticks:[e],count:1,firstTickIndex:0};if(i<2)return{ticks:[e,t],count:2,firstTickIndex:0};const o=Yi(e,t,i,s,n);if(!Number.isFinite(o))return{ticks:[],count:0,firstTickIndex:void 0};let c=e,a=t;Wi(c/o,1e-12)||(c=Math.ceil(c/o)*o),Wi(a/o,1e-12)||(a=Math.floor(a/o)*o),r!=null&&(r=rr(r,[e,t],[c,a]));const{ticks:h}=Xi(c,a,o,r),l=h.at(0);return{ticks:h,count:ji(c,a,o),firstTickIndex:l==null?void 0:Math.round((l-c)/o)}}var Mo=Math.floor(2*Wn/Gi*10)/10;function Yi(e,t,i,s=0,n=1/0){if(e===t)return sr(1,s,n);if(i<1)return NaN;const r=Math.abs(t-e),o=10**Math.floor(Math.log10(r/i));let c=NaN,a=1/0,h=!1;for(const l of Hi){const u=Math.ceil(r/(l*o)),d=u>=s&&u<=n;if(h&&!d)continue;const f=Math.abs(u-i);(a>f||h!==d)&&(h||(h=d),a=f,c=l)}return c*o}function Xi(e,t,i,s){if(!Number.isFinite(i)||i<=0)return{ticks:[],count:0,firstTickIndex:void 0};if(e===t)return{ticks:[e],count:1,firstTickIndex:0};const n=10**nr(i),r=Math.min(e,t),o=Math.max(e,t);let c,a;if(s!=null&&(s[0]!==0||s[1]!==1)){const u=t-e,d=e+u*s[0],f=t-u*(1-s[1]);c=Math.min(d,f),a=Math.max(d,f)}else c=r,a=o;c=Math.floor(c*n)/n,a=Math.ceil(a*n)/n;const h=[];for(let u=0;;u+=1){const d=Math.round((r+i*u)*n)/n;if(d>o)break;d>=c&&d<=a&&h.push(d)}const l=h.at(0);return{ticks:h,count:ji(r,o,i),firstTickIndex:l==null?void 0:Math.round((l-r)/i)}}function ar(e,t){return e>=t?(ir.warnOnce("the configured interval results in more than 1 item per pixel, ignoring. Supply a larger interval or omit this configuration"),!0):!1}function cr(e,t){const i=Math.abs(t-e),s=10**Math.floor(Math.log10(i));let n=1/0,r=[e,t];for(const o of Hi){const c=o*s,a=Math.floor(e/c)*c,h=Math.ceil(t/c)*c,l=1-i/Math.abs(h-a);n>l&&(n=l,r=[a,h])}return r}var Ui=class qe extends ye{constructor(t=[],i=[]){super(),this.domain=t,this.range=i,this.defaultTickCount=qe.defaultTickCount,this.defaultClamp=!1}static is(t){return t instanceof qe}normalizeDomains(...t){return hr(...t)}calcBandwidth(t=1,i=1){const{domain:s}=this,n=this.getPixelRange();if(s.length===0)return n;let o=Math.abs(s[1].valueOf()-s[0].valueOf())/t+1;if(i!==0){const c=Math.floor(n);o=Math.min(o,c)}return n/Math.max(1,o)}convert(t,i){const{domain:s}=this;if(!s||s.length<2||t==null)return NaN;const{range:n}=this,r=i?.clamp??this.defaultClamp;let o=s[0].valueOf(),c=s[1].valueOf(),a=t.valueOf();if(this.transform&&(o=this.transform(o),c=this.transform(c),a=this.transform(a)),r){const[l,u]=Hn([o,c]);if(a<l)return n[0];if(a>u)return n[1]}if(o===c)return(n[0]+n[1])/2;if(a===o)return n[0];if(a===c)return n[1];const h=n[0];return h+(a-o)/(c-o)*(n[1]-h)}invert(t,i){const{domain:s}=this;if(s.length<2)return;let n=s[0].valueOf(),r=s[1].valueOf();this.transform&&(n=this.transform(n),r=this.transform(r));const{range:o}=this,[c,a]=o;let h;return c===a?h=this.toDomain((n+r)/2):h=this.toDomain(n+(t-c)/(a-c)*(r-n)),this.transformInvert?this.transformInvert(h):h}getPixelRange(){const[t,i]=this.range;return Math.abs(i-t)}};Ui.defaultTickCount=5;var Qt=Ui;function hr(...e){let t,i=1/0,s,n=-1/0;for(const r of e)for(const o of r){const c=o.valueOf();c<i&&(i=c,t=o),c>n&&(n=c,s=o)}return t!=null&&s!=null?{domain:[t,s],animatable:!0}:{domain:[],animatable:!1}}var lr=class $e extends Qt{constructor(){super([0,1],[0,1]),this.type="number"}static is(t){return t instanceof $e}static getTickStep(t,i,s){const{interval:n,tickCount:r=Qt.defaultTickCount,minTickCount:o,maxTickCount:c}=s;return n??Yi(t,i,r,o,c)}toDomain(t){return t}ticks({interval:t,tickCount:i=Qt.defaultTickCount,minTickCount:s,maxTickCount:n},r=this.domain,o){if(!r||r.length<2||i<1||!r.every(isFinite))return{ticks:[],count:0,firstTickIndex:0};const[c,a]=r;if(t){const h=Math.abs(t);if(!ar((a-c)/h,this.getPixelRange()))return Xi(c,a,h,o)}return or(c,a,i,s,n,o)}niceDomain(t,i=this.domain){if(i.length<2)return[];const{tickCount:s=Qt.defaultTickCount}=t;let[n,r]=i;if(s===1)[n,r]=cr(n,r);else if(s>1){const o=n>r?Math.ceil:Math.floor,c=n>r?Math.floor:Math.ceil,a=4;for(let h=0;h<a;h++){const l=n,u=r,d=$e.getTickStep(n,r,t),[f,p]=i;if(n=o(f/d)*d,r=c(p/d)*d,n===l&&r===u)break}}return[n,r]}};import{CleanupRegistry as ur,EventEmitter as dr,Logger as fr,createId as pr,downloadUrl as gr}from"ag-charts-core";import{createElement as mr,getWindow as yr}from"ag-charts-core";var Vi=class{constructor(e){this.enabled=!0,this.width=600,this.height=300;const{width:t,height:i,canvasElement:s,willReadFrequently:n=!1}=e;this.pixelRatio=e.pixelRatio??yr("devicePixelRatio")??1,this.element=s??mr("canvas"),this.element.style.display="block",this.element.style.width=(t??this.width)+"px",this.element.style.height=(i??this.height)+"px",this.element.width=Math.round((t??this.width)*this.pixelRatio),this.element.height=Math.round((i??this.height)*this.pixelRatio),this.context=this.element.getContext("2d",{willReadFrequently:n}),this.onEnabledChange(),this.resize(t??0,i??0,this.pixelRatio),ci(this.context)}drawImage(e,t=0,i=0){return e.drawImage(this.context.canvas,t,i)}toDataURL(e){return this.element.toDataURL(e)}resize(e,t,i){if(!(e>0&&t>0))return;const{element:s,context:n}=this;s.width=Math.round(e*i),s.height=Math.round(t*i),n.setTransform(i,0,0,i,0,0),s.style.width=e+"px",s.style.height=t+"px",this.width=e,this.height=t,this.pixelRatio=i}clear(){ai(this)}destroy(){this.element.remove(),this.element.width=0,this.element.height=0,this.context.clearRect(0,0,0,0),Object.freeze(this)}reset(){this.context.reset(),this.context.verifyDepthZero?.()}onEnabledChange(){this.element&&(this.element.style.display=this.enabled?"":"none")}};b([qn(e=>e.onEnabledChange())],Vi.prototype,"enabled",2);import{EventEmitter as br}from"ag-charts-core";var xr=class extends br{constructor(){super(...arguments),this.cache=new Map,this.imageLoadingCount=0}loadImage(e,t){const i=this.cache.get(e);if(i?.image)return i.image;if(i!=null&&t){i.nodes.add(t);return}if(!t)return;const s={image:void 0,nodes:new Set([t])},n=new Image;return this.imageLoadingCount++,n.onload=()=>{s.image=n;for(const r of s.nodes)r.markDirty();s.nodes.clear(),this.imageLoadingCount--,this.emit("image-loaded",{uri:e})},n.onerror=()=>{this.imageLoadingCount--,s.nodes.clear(),this.emit("image-error",{uri:e})},n.src=e,this.cache.set(e,s),s.image}waitingToLoad(){return this.imageLoadingCount>0}destroy(){this.cache.forEach(e=>{e.nodes.clear()}),this.cache.clear()}},Mr=class{constructor(e){this.canvas=e,this.debug=j.create(!0,"scene"),this.layersMap=new Map,this.nextLayerId=0}get size(){return this.layersMap.size}resize(e,t,i){this.canvas.resize(e,t,i),this.layersMap.forEach(({canvas:s})=>s.resize(e,t,i))}addLayer(e){const{width:t,height:i,pixelRatio:s}=this.canvas,{name:n}=e,r=new le({width:t,height:i,pixelRatio:s});return this.layersMap.set(r,{id:this.nextLayerId++,name:n,canvas:r}),this.debug("Scene.addLayer() - layers",this.layersMap),r}removeLayer(e){this.layersMap.has(e)&&(this.layersMap.delete(e),e.destroy(),this.debug("Scene.removeLayer() -  layers",this.layersMap))}clear(){for(const e of this.layersMap.values())e.canvas.destroy();this.layersMap.clear()}},Ki=class extends dr{constructor(e){super(),this.debug=j.create(!0,"scene"),this.id=pr(this),this.imageLoader=new xr,this.root=null,this.pendingSize=null,this.isDirty=!1,this.cleanup=new ur,this.updateDebugFlags(),this.canvas=new Vi(e),this.layersManager=new Mr(this.canvas),this.cleanup.register(this.imageLoader.on("image-loaded",()=>{this.emit("scene-changed",{})}),this.imageLoader.on("image-error",({uri:t})=>{fr.warnOnce(`Unable to load image ${t}`)}))}waitingForUpdate(){return this.imageLoader?.waitingToLoad()??!1}get width(){return this.pendingSize?.[0]??this.canvas.width}get height(){return this.pendingSize?.[1]??this.canvas.height}get pixelRatio(){return this.pendingSize?.[2]??this.canvas.pixelRatio}setContainer(e){const{element:t}=this.canvas;return t.parentElement?.removeChild(t),e.appendChild(t),this}setRoot(e){return this.root===e?this:(this.isDirty=!0,this.root?.setScene(),this.root=e,e&&(e.visible=!0,e.setScene(this)),this)}updateDebugFlags(){j.inDevelopmentMode(()=>Dt._debugEnabled=!0)}clearCanvas(){this.canvas.clear()}attachNode(e){return this.appendChild(e),()=>this.removeChild(e)}appendChild(e){return this.root?.appendChild(e),this}removeChild(e){return this.root?.removeChild(e),this}download(e,t){gr(this.canvas.toDataURL(t),e?.trim()??"image")}getDataURL(e){return this.canvas.toDataURL(e)}resize(e,t,i){return e=Math.round(e),t=Math.round(t),i??(i=this.pixelRatio),e>0&&t>0&&(e!==this.width||t!==this.height||i!==this.pixelRatio)?(this.pendingSize=[e,t,i],this.isDirty=!0,!0):!1}render(e){const{debugSplitTimes:t={start:performance.now()},extraDebugStats:i,seriesRect:s}=e??{},{canvas:n,canvas:{context:r}={},root:o,pendingSize:c,width:a,height:h,pixelRatio:l}=this;if(!r)return;const u=performance.now();let d=!1;if(c&&(d=!0,this.layersManager.resize(...c),this.pendingSize=null),o&&!o.visible){this.isDirty=!1;return}let f;if(o instanceof U&&(f=o.dirty),o!=null&&f===!1&&!this.isDirty){this.debug.check()&&this.debug("Scene.render() - no-op",{tree:jt(o,"console")}),Oi(this.layersManager,t,r,void 0,i,s);return}const p={ctx:r,width:a,height:h,devicePixelRatio:l,debugNodes:{}};j.check("scene:stats:verbose")&&(p.stats={layersRendered:0,layersSkipped:0,nodesRendered:0,nodesSkipped:0,opsPerformed:0,opsSkipped:0}),In(p);let g=!1;if((f!==!1||d)&&(g=!0,n.clear()),o&&j.check("scene:dirtyTree")){const{dirtyTree:m,paths:y}=Ni(o);j.create("scene:dirtyTree")("Scene.render() - dirtyTree",{dirtyTree:m,paths:y})}if(o&&g){if(o.visible&&o.preRender(p),this.debug.check()){const m=jt(o,"console");this.debug("Scene.render() - before",{canvasCleared:g,tree:m})}if(o.visible)try{r.save(),o.render(p),r.restore()}catch(m){throw this.canvas.reset(),m}}t["\u270D\uFE0F"]=performance.now()-u,r.verifyDepthZero?.(),this.isDirty=!1,Oi(this.layersManager,t,r,p.stats,i,s),On(r,p.debugNodes),o&&this.debug.check()&&this.debug("Scene.render() - after",{tree:jt(o,"console"),canvasCleared:g})}toSVG(){const{root:e,width:t,height:i}=this;if(e!=null)return Dt.toSVG(e,t,i)}strip(){const{context:e,pixelRatio:t}=this.canvas;e.setTransform(t,0,0,t,0,0),this.layersManager.clear(),this.setRoot(null),this.isDirty=!1,this.clear()}destroy(){this.strip(),this.canvas.destroy(),this.imageLoader.destroy(),this.cleanup.flush(),Object.assign(this,{canvas:void 0})}};Ki.className="Scene";import{isNumberEqual as vr}from"ag-charts-core";var it=class extends Z{constructor(){super(...arguments),this.centerX=0,this.centerY=0,this.radius=10,this.startAngle=0,this.endAngle=Math.PI*2,this.counterClockwise=!1,this.type=0}get fullPie(){return vr(G(this.startAngle),G(this.endAngle))}updatePath(){const e=this.path;e.clear(),e.arc(this.centerX,this.centerY,this.radius,this.startAngle,this.endAngle,this.counterClockwise),this.type===1?e.closePath():this.type===2&&!this.fullPie&&(e.lineTo(this.centerX,this.centerY),e.closePath())}computeBBox(){return new z(this.centerX-this.radius,this.centerY-this.radius,this.radius*2,this.radius*2)}isPointInPath(e,t){const i=this.getBBox();return this.type!==0&&i.containsPoint(e,t)&&this.path.isPointInPath(e,t)}};it.className="Arc",b([x()],it.prototype,"centerX",2),b([x()],it.prototype,"centerY",2),b([x()],it.prototype,"radius",2),b([x()],it.prototype,"startAngle",2),b([x()],it.prototype,"endAngle",2),b([x()],it.prototype,"counterClockwise",2),b([x()],it.prototype,"type",2);import{createSvgElement as Sr}from"ag-charts-core";var Mt=class extends _{constructor(e={}){super(e),this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.fill=void 0,this.strokeWidth=1}set x(e){this.x1=e,this.x2=e}set y(e){this.y1=e,this.y2=e}get midPoint(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}}computeBBox(){return new z(Math.min(this.x1,this.x2),Math.min(this.y1,this.y2),Math.abs(this.x2-this.x1),Math.abs(this.y2-this.y1))}isPointInPath(e,t){return this.x1===this.x2||this.y1===this.y2?this.getBBox().clone().grow(this.strokeWidth/2).containsPoint(e,t):!1}distanceSquared(e,t){const{x1:i,y1:s,x2:n,y2:r}=this;return we(e,t,i,s,n,r,1/0)}render(e){const{ctx:t,devicePixelRatio:i}=e;let{x1:s,y1:n,x2:r,y2:o}=this;if(s===r){const{strokeWidth:c}=this,a=Math.round(s*i)/i+Math.trunc(c*i)%2/(i*2);s=a,r=a}else if(n===o){const{strokeWidth:c}=this,a=Math.round(n*i)/i+Math.trunc(c*i)%2/(i*2);n=a,o=a}t.beginPath(),t.moveTo(s,n),t.lineTo(r,o),this.fillStroke(t),this.fillShadow?.markClean(),super.render(e)}toSVG(){if(!this.visible)return;const e=Sr("line");return e.setAttribute("x1",String(this.x1)),e.setAttribute("y1",String(this.y1)),e.setAttribute("x2",String(this.x2)),e.setAttribute("y2",String(this.y2)),this.applySvgStrokeAttributes(e),{elements:[e]}}};Mt.className="Line",b([x()],Mt.prototype,"x1",2),b([x()],Mt.prototype,"y1",2),b([x()],Mt.prototype,"x2",2),b([x()],Mt.prototype,"y2",2);import{isNumberEqual as _e}from"ag-charts-core";function Be(e,t,i){const s=Math.sqrt(e**2+t**2),r=Math.atan2(t,e)+i;return{x:Math.cos(r)*s,y:Math.sin(r)*s}}var K=class extends Z{constructor(){super(...arguments),this.isBeveled=!0,this.columnWidth=0,this.startAngle=0,this.endAngle=0,this.outerRadius=0,this.innerRadius=0,this.axisInnerRadius=0,this.axisOuterRadius=0,this.isRadiusAxisReversed=!1}set cornerRadius(e){}computeBBox(){const{innerRadius:e,outerRadius:t,columnWidth:i}=this,s=this.getRotation(),n=-i/2,r=i/2,o=-t,c=-e;let a=1/0,h=1/0,l=-1/0,u=-1/0;for(let d=0;d<4;d+=1){const{x:f,y:p}=Be(d%2===0?n:r,d<2?o:c,s);a=Math.min(f,a),h=Math.min(p,h),l=Math.max(f,l),u=Math.max(p,u)}return new z(a,h,l-a,u-h)}getRotation(){const{startAngle:e,endAngle:t}=this,i=de(e,t);return G(e+i/2+Math.PI/2)}updatePath(){const{isBeveled:e}=this;e?this.updateBeveledPath():this.updateRectangularPath(),this.checkPathDirty()}updateRectangularPath(){const{columnWidth:e,innerRadius:t,outerRadius:i,path:s}=this,n=-e/2,r=e/2,o=-i,c=-t,a=this.getRotation(),h=[[n,c],[n,o],[r,o],[r,c]].map(([l,u])=>Be(l,u,a));s.clear(!0),s.moveTo(h[0].x,h[0].y),s.lineTo(h[1].x,h[1].y),s.lineTo(h[2].x,h[2].y),s.lineTo(h[3].x,h[3].y),s.closePath()}updateBeveledPath(){const{columnWidth:e,path:t,outerRadius:i,innerRadius:s,axisInnerRadius:n,axisOuterRadius:r,isRadiusAxisReversed:o}=this,c=_e(s,n),a=Math.asin(e/2/s),h=this.getRotation(),l=(S,C)=>Be(S,C,h),u=(S,C)=>Math.sqrt(S**2+C**2),d=(S,C)=>C>S?0:Math.sqrt(S**2-C**2),f=(S,C,T)=>T?S<C:S>C,p=c&&!isNaN(a)&&a<Math.PI/6;let g=-e/2,m=e/2;const y=-i,v=-s*(p?Math.cos(a):1),P=f(r,u(s,e/2),!o);if(P){const S=d(r,s);g=-S,m=S}t.clear(!0);const w=l(g,v);t.moveTo(w.x,w.y);const A=_e(s,i),k=f(r,u(i,e/2),!o);if(A&&p)t.arc(0,0,s,G(-a-Math.PI/2)+h,G(a-Math.PI/2)+h,!1);else if(k){const S=-d(r,e/2),C=d(r,i);if(!P){const T=l(g,S);t.lineTo(T.x,T.y)}if(t.arc(0,0,r,Math.atan2(S,g)+h,Math.atan2(y,-C)+h,!1),!_e(C,0)){const T=l(C,y);t.lineTo(T.x,T.y)}t.arc(0,0,r,Math.atan2(y,C)+h,Math.atan2(S,m)+h,!1)}else{const S=l(g,y),C=l(m,y);t.lineTo(S.x,S.y),t.lineTo(C.x,C.y)}const M=l(m,v);if(t.lineTo(M.x,M.y),p)t.arc(0,0,s,G(a-Math.PI/2)+h,G(-a-Math.PI/2)+h,!0);else{const S=l(g,v);t.lineTo(S.x,S.y)}t.closePath()}};K.className="RadialColumnShape",b([x()],K.prototype,"isBeveled",2),b([x()],K.prototype,"columnWidth",2),b([x()],K.prototype,"startAngle",2),b([x()],K.prototype,"endAngle",2),b([x()],K.prototype,"outerRadius",2),b([x()],K.prototype,"innerRadius",2),b([x()],K.prototype,"axisInnerRadius",2),b([x()],K.prototype,"axisOuterRadius",2),b([x()],K.prototype,"isRadiusAxisReversed",2);function Cr(e,t,i,s,n){const r=de(e,t),o=r*(1-s)/2;if(e+=o,t-=o,r<.001)return 2*i*n;if(r>=2*Math.PI){const f=e+r/2;e=f-Math.PI,t=f+Math.PI}const c=i*Math.cos(e),a=i*Math.sin(e),h=i*Math.cos(t),l=i*Math.sin(t),u=Math.floor(Math.sqrt((c-h)**2+(a-l)**2)),d=2*i*n;return Math.max(1,Math.min(d,u))}var Pr=class He{constructor(t,i,s,n){this.startAngle=t,this.endAngle=i,this.innerRadius=s,this.outerRadius=n}clone(){const{startAngle:t,endAngle:i,innerRadius:s,outerRadius:n}=this;return new He(t,i,s,n)}equals(t){return this.startAngle===t.startAngle&&this.endAngle===t.endAngle&&this.innerRadius===t.innerRadius&&this.outerRadius===t.outerRadius}[ei](t,i){return new He(this.startAngle*(1-i)+t.startAngle*i,this.endAngle*(1-i)+t.endAngle*i,this.innerRadius*(1-i)+t.innerRadius*i,this.outerRadius*(1-i)+t.outerRadius*i)}};function wr({startAngle:e,endAngle:t,innerRadius:i,outerRadius:s}){let n=1/0,r=1/0,o=-1/0,c=-1/0;const a=(h,l)=>{n=Math.min(h,n),r=Math.min(l,r),o=Math.max(h,o),c=Math.max(l,c)};return a(i*Math.cos(e),i*Math.sin(e)),a(i*Math.cos(t),i*Math.sin(t)),a(s*Math.cos(e),s*Math.sin(e)),a(s*Math.cos(t),s*Math.sin(t)),zt(0,e,t)&&a(s,0),zt(Math.PI*.5,e,t)&&a(0,s),zt(Math.PI,e,t)&&a(-s,0),zt(Math.PI*1.5,e,t)&&a(0,-s),new z(n,r,o-n,c-r)}function Ji(e,t,i){const s=Math.sqrt(Math.pow(e,2)+Math.pow(t,2)),{innerRadius:n,outerRadius:r}=i;if(i.startAngle===i.endAngle||s<Math.min(n,r)||s>Math.max(n,r))return!1;const o=li(i.startAngle),c=li(i.endAngle),a=Math.atan2(t,e);return o<c?a<=c&&a>=o:a<=c&&a>=-Math.PI||a>=o&&a<=Math.PI}function Zi(e,t,i,s){if(i===0&&s===0)return 0;if(Math.asin(Math.abs(1*i)/(e+1*i))+Math.asin(Math.abs(1*s)/(e+1*s))-t<0)return 1;let r=0,o=1;for(let c=0;c<8;c+=1){const a=(r+o)/2;Math.asin(Math.abs(a*i)/(e+a*i))+Math.asin(Math.abs(a*s)/(e+a*s))-t<0?r=a:o=a}return r}var kr=1e-6;function at(e,t){return de(e,t)<kr?t:G(e-t)+t}function te(e,t,i=0){const n=Math.abs(t-e)>=2*Math.PI?2*Math.PI:G(t-e);return e=at(e,i),t=e+n,{startAngle:e,endAngle:t}}function ee(e,t,i,s,n,r){const o=Math.sin(r),c=Math.cos(r),a=e**2+t**2-i**2;let h,l,u,d;if(c>.5){const P=o/c,w=1+P**2,A=-2*(e+t*P),k=A**2-4*w*a;if(k<0)return;const M=(-A+Math.sqrt(k))/(2*w),S=(-A-Math.sqrt(k))/(2*w);h=M,l=M*P,u=S,d=S*P}else{const P=c/o,w=1+P**2,A=-2*(t+e*P),k=A**2-4*w*a;if(k<0)return;const M=(-A+Math.sqrt(k))/(2*w),S=(-A-Math.sqrt(k))/(2*w);h=M*P,l=M,u=S*P,d=S}const f=c,p=o,g=h*f+l*p,m=u*f+d*p,y=g>0?at(Math.atan2(l-t,h-e),s):NaN,v=m>0?at(Math.atan2(d-t,u-e),s):NaN;if(y>=s&&y<=n)return y;if(v>=s&&v<=n)return v}function ie(e,t,i,s,n,r){const o=Math.hypot(e,t),c=(o**2-i**2+r**2)/(2*o),a=o-c,h=Math.atan2(t,e),l=Math.acos(-a/i),u=at(h+l,s),d=at(h-l,s);if(u>=s&&u<=n)return u;if(d>=s&&d<=n)return d}var ze=class{constructor(e,t,i,s,n){this.cx=e,this.cy=t,this.r=i,this.a0=s,this.a1=n,this.a0>=this.a1&&(this.a0=NaN,this.a1=NaN)}isValid(){return Number.isFinite(this.a0)&&Number.isFinite(this.a1)}pointAt(e){return{x:this.cx+this.r*Math.cos(e),y:this.cy+this.r*Math.sin(e)}}clipStart(e){e==null||!this.isValid()||e<this.a0||(this.a0=e,(Number.isNaN(e)||this.a0>=this.a1)&&(this.a0=NaN,this.a1=NaN))}clipEnd(e){e==null||!this.isValid()||e>this.a1||(this.a1=e,(Number.isNaN(e)||this.a0>=this.a1)&&(this.a0=NaN,this.a1=NaN))}},Y=class extends Z{constructor(){super(...arguments),this.centerX=0,this.centerY=0,this.innerRadius=10,this.outerRadius=20,this.startAngle=0,this.endAngle=Math.PI*2,this.clipSector=void 0,this.concentricEdgeInset=0,this.radialEdgeInset=0,this.startOuterCornerRadius=0,this.endOuterCornerRadius=0,this.startInnerCornerRadius=0,this.endInnerCornerRadius=0}set inset(e){this.concentricEdgeInset=e,this.radialEdgeInset=e}set cornerRadius(e){this.startOuterCornerRadius=e,this.endOuterCornerRadius=e,this.startInnerCornerRadius=e,this.endInnerCornerRadius=e}computeBBox(){return wr(this).translate(this.centerX,this.centerY)}normalizedRadii(){const{concentricEdgeInset:e}=this;let{innerRadius:t,outerRadius:i}=this;return t=t>0?t+e:0,i=Math.max(i-e,0),{innerRadius:t,outerRadius:i}}normalizedClipSector(){const{clipSector:e}=this;if(e==null)return;const{startAngle:t,endAngle:i}=te(this.startAngle,this.endAngle),{innerRadius:s,outerRadius:n}=this.normalizedRadii(),r=te(e.startAngle,e.endAngle,t);return new Pr(Math.max(t,r.startAngle),Math.min(i,r.endAngle),Math.max(s,e.innerRadius),Math.min(n,e.outerRadius))}getAngleOffset(e){return e>0?this.radialEdgeInset/e:0}arc(e,t,i,s,n,r,o,c){if(e<=0)return;const{startAngle:a,endAngle:h}=te(this.startAngle,this.endAngle),{innerRadius:l,outerRadius:u}=this.normalizedRadii(),d=this.normalizedClipSector();if(c&&l<=0)return;const f=c?this.getAngleOffset(l+e):this.getAngleOffset(u-e),p=o?a+f+t:h-f-t,g=c?l+e:u-e,m=g*Math.cos(p),y=g*Math.sin(p);if(d!=null&&(!o&&!(p>=a-1e-6&&p<=d.endAngle-1e-6)||o&&!(p>=d.startAngle+1e-6&&p<=h-1e-6)||c&&g<d.innerRadius-1e-6||!c&&g>d.outerRadius+1e-6))return;const v=new ze(m,y,e,i,s);if(d!=null){c?(v.clipStart(ee(m,y,e,i,s,d.endAngle)),v.clipEnd(ee(m,y,e,i,s,d.startAngle))):(v.clipStart(ee(m,y,e,i,s,d.startAngle)),v.clipEnd(ee(m,y,e,i,s,d.endAngle)));let M,S;if(o?(M=ie(m,y,e,i,s,d.innerRadius),S=ie(m,y,e,i,s,d.outerRadius)):(M=ie(m,y,e,i,s,d.outerRadius),S=ie(m,y,e,i,s,d.innerRadius)),v.clipStart(M),v.clipEnd(S),M!=null){const{x:C,y:T}=v.pointAt(M),R=at(Math.atan2(T,C),a);o?r?.clipStart(R):n.clipEnd(R)}if(S!=null){const{x:C,y:T}=v.pointAt(S),R=at(Math.atan2(T,C),a);o?n.clipStart(R):r?.clipEnd(R)}}if(d!=null){const{x:M,y:S}=v.pointAt((v.a0+v.a1)/2);if(!Ji(M,S,d))return}const{x:P,y:w}=v.pointAt(o===c?v.a0:v.a1),A=at(Math.atan2(w,P),a),k=c?r:n;return o?k?.clipStart(A):k?.clipEnd(A),v}updatePath(){const{path:t,centerX:i,centerY:s,concentricEdgeInset:n,radialEdgeInset:r}=this;let{startOuterCornerRadius:o,endOuterCornerRadius:c,startInnerCornerRadius:a,endInnerCornerRadius:h}=this;const{startAngle:l,endAngle:u}=te(this.startAngle,this.endAngle),{innerRadius:d,outerRadius:f}=this.normalizedRadii(),p=this.normalizedClipSector(),g=u-l,m=g>=2*Math.PI-1e-6;if(t.clear(),d===0&&f===0||d>f)return;if((p?.startAngle??l)===(p?.endAngle??u))return;if(m&&this.clipSector==null&&o===0&&c===0&&a===0&&h===0){t.moveTo(i+f*Math.cos(l),s+f*Math.sin(l)),t.arc(i,s,f,l,u),d>n&&(t.moveTo(i+d*Math.cos(u),s+d*Math.sin(u)),t.arc(i,s,d,u,l,!0)),t.closePath();return}else if(this.clipSector==null&&Math.abs(d-f)<1e-6){t.arc(i,s,f,l,u,!1),t.arc(i,s,f,u,l,!0),t.closePath();return}const y=this.getAngleOffset(d),v=this.getAngleOffset(f);if(g<2*v)return;const w=(p?.innerRadius??d)>n,A=d<n||g<2*y,k=f-d,M=Math.max(o,a,c,h),S=M>0?Math.min(k/M,1):1;o*=S,c*=S,a*=S,h*=S;const C=Zi(f,g-2*v,-o,-c);if(o*=C,c*=C,!A&&w){const I=Zi(d,g-2*y,a,h);a*=I,h*=I}else a=0,h=0;const T=Math.max(o+a,c+h),R=T>0?Math.min(k/T,1):1;o*=R,c*=R,a*=R,h*=R;let N=0,B=0;const pt=o/(f-o),gt=c/(f-c);if(pt>=0&&pt<1-1e-6)N=Math.asin(pt);else{N=g/2;const I=f/(1/Math.sin(N)+1);o=Math.min(I,o)}if(gt>=0&&gt<1-1e-6)B=Math.asin(gt);else{B=g/2;const I=f/(1/Math.sin(B)+1);c=Math.min(I,c)}const St=Math.asin(a/(d+a)),Ct=Math.asin(h/(d+h)),Pt=p?.outerRadius??f,wt=this.getAngleOffset(Pt),nt=new ze(0,0,Pt,l+wt,u-wt),We=p?.innerRadius??d,je=this.getAngleOffset(We),Q=w?new ze(0,0,We,l+je,u-je):void 0;p!=null&&(nt.clipStart(p.startAngle),nt.clipEnd(p.endAngle),Q?.clipStart(p.startAngle),Q?.clipEnd(p.endAngle));const Ye=this.arc(o,N,l-Math.PI*.5,l+N,nt,Q,!0,!1),Xe=this.arc(c,B,u-B,u+Math.PI*.5,nt,Q,!1,!1),Ue=this.arc(h,Ct,u+Math.PI*.5,u+Math.PI-Ct,nt,Q,!1,!0),ne=this.arc(a,St,l+Math.PI+St,l+Math.PI*1.5,nt,Q,!0,!0);if(A){const I=g<Math.PI*.5?r*(1+Math.cos(g))/Math.sin(g):NaN;let E;I>0&&I<f?E=Math.max(Math.hypot(r,I),d):E=r,E=Math.max(E,d);const q=l+g*.5;t.moveTo(i+E*Math.cos(q),s+E*Math.sin(q))}else if(!(ne?.isValid()===!0||Q?.isValid()===!0)){const I=l+g/2,E=d*Math.cos(I),q=d*Math.sin(I);t.moveTo(i+E,s+q)}if(Ye?.isValid()===!0){const{cx:I,cy:E,r:q,a0:ct,a1:ht}=Ye;t.arc(i+I,s+E,q,ct,ht)}if(nt.isValid()){const{r:I,a0:E,a1:q}=nt;t.arc(i,s,I,E,q)}if(Xe?.isValid()===!0){const{cx:I,cy:E,r:q,a0:ct,a1:ht}=Xe;t.arc(i+I,s+E,q,ct,ht)}if(!A){if(Ue?.isValid()===!0){const{cx:I,cy:E,r:q,a0:ct,a1:ht}=Ue;t.arc(i+I,s+E,q,ct,ht)}if(Q?.isValid()===!0){const{r:I,a0:E,a1:q}=Q;t.arc(i,s,I,q,E,!0)}if(ne?.isValid()===!0){const{cx:I,cy:E,r:q,a0:ct,a1:ht}=ne;t.arc(i+I,s+E,q,ct,ht)}}t.closePath()}isPointInPath(e,t){const{startAngle:i,endAngle:s,innerRadius:n,outerRadius:r}=this.clipSector??this;return Ji(e-this.centerX,t-this.centerY,{startAngle:i,endAngle:s,innerRadius:Math.min(n,r),outerRadius:Math.max(n,r)})}};Y.className="Sector",b([x()],Y.prototype,"centerX",2),b([x()],Y.prototype,"centerY",2),b([x()],Y.prototype,"innerRadius",2),b([x()],Y.prototype,"outerRadius",2),b([x()],Y.prototype,"startAngle",2),b([x()],Y.prototype,"endAngle",2),b([tt({equals:(e,t)=>e.equals(t)})],Y.prototype,"clipSector",2),b([x()],Y.prototype,"concentricEdgeInset",2),b([x()],Y.prototype,"radialEdgeInset",2),b([x()],Y.prototype,"startOuterCornerRadius",2),b([x()],Y.prototype,"endOuterCornerRadius",2),b([x()],Y.prototype,"startInnerCornerRadius",2),b([x()],Y.prototype,"endInnerCornerRadius",2);export{it as Arc,z as BBox,W as Caption,tr as CategoryScale,U as Group,Mt as Line,lr as LinearScale,Vt as Marker,Z as Path,K as RadialColumnShape,V as Rect,Ki as Scene,Y as Sector,_ as Shape,wn as TranslatableGroup,Cr as getRadialColumnWidth,J as toRadians};
